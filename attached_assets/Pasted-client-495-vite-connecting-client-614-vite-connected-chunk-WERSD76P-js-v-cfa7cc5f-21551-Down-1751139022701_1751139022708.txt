client:495 [vite] connecting...
client:614 [vite] connected.
chunk-WERSD76P.js?v=cfa7cc5f:21551 Download the React DevTools for a better development experience: https://reactjs.org/link/react-devtools
AnalyticsProvider.tsx:21 Analytics initialized: false
wizard-design.tsx:2561 📊 WIZARD: Pasando airEntries a Canvas2D
wizard-design.tsx:2562 📊 WIZARD: rawFloors[ground] existe: true
wizard-design.tsx:2563 📊 WIZARD: rawFloors[ground]?.airEntries length: 1
wizard-design.tsx:2564 📊 WIZARD: fallback airEntries length: 1
wizard-design.tsx:2565 📊 WIZARD: Usando rawAirEntries: SÍ (rawFloors)
wizard-design.tsx:2568 📊 WIZARD: Primer airEntry enviado a Canvas2D - posición: (684.5155848099347, 42.01276434901955)
Canvas2D.tsx:408 🔗 Canvas2D: Registrando suscripción para piso 'ground'
Canvas2D.tsx:409 🔗 Canvas2D: subscribeToAirEntryChanges función disponible: true
room-store.ts:469 🔗 STORE: Nueva suscripción añadida. Total listeners: 1
Canvas2D.tsx:436 🔗 Canvas2D: Suscripción creada exitosamente: true
chunk-WERSD76P.js?v=cfa7cc5f:377 [Violation] 'message' handler took 264ms
dashboard-sidebar.tsx:65 
            
            
           GET https://e6d70a7c-6e99-4261-89d9-79d6b4d4c145-00-2hh1t74mr2tvm.worf.replit.dev/api/auth/user 401 (Unauthorized)
fetchUserData @ dashboard-sidebar.tsx:65
(anonymous) @ dashboard-sidebar.tsx:80
commitHookEffectListMount @ chunk-WERSD76P.js?v=cfa7cc5f:16915
commitPassiveMountOnFiber @ chunk-WERSD76P.js?v=cfa7cc5f:18156
commitPassiveMountEffects_complete @ chunk-WERSD76P.js?v=cfa7cc5f:18129
commitPassiveMountEffects_begin @ chunk-WERSD76P.js?v=cfa7cc5f:18119
commitPassiveMountEffects @ chunk-WERSD76P.js?v=cfa7cc5f:18109
flushPassiveEffectsImpl @ chunk-WERSD76P.js?v=cfa7cc5f:19490
flushPassiveEffects @ chunk-WERSD76P.js?v=cfa7cc5f:19447
performSyncWorkOnRoot @ chunk-WERSD76P.js?v=cfa7cc5f:18868
flushSyncCallbacks @ chunk-WERSD76P.js?v=cfa7cc5f:9119
commitRootImpl @ chunk-WERSD76P.js?v=cfa7cc5f:19432
commitRoot @ chunk-WERSD76P.js?v=cfa7cc5f:19277
finishConcurrentRender @ chunk-WERSD76P.js?v=cfa7cc5f:18805
performConcurrentWorkOnRoot @ chunk-WERSD76P.js?v=cfa7cc5f:18718
workLoop @ chunk-WERSD76P.js?v=cfa7cc5f:197
flushWork @ chunk-WERSD76P.js?v=cfa7cc5f:176
performWorkUntilDeadline @ chunk-WERSD76P.js?v=cfa7cc5f:384
analytics.ts:26 Google Analytics initialized with ID: G-XZYY9DVVHW
useAnalytics.ts:59 Google Analytics initialized successfully
useAnalytics.ts:59 Google Analytics initialized successfully
useAnalytics.ts:59 Google Analytics initialized successfully
AnalyticsProvider.tsx:21 Analytics initialized: true
js?id=G-XZYY9DVVHW:663 [Violation] 'setTimeout' handler took 76ms

                
          
          
          
         Chrome is moving towards a new experience that allows users to choose to browse without third-party cookies.
wizard-design.tsx:2561 📊 WIZARD: Pasando airEntries a Canvas2D
wizard-design.tsx:2562 📊 WIZARD: rawFloors[ground] existe: true
wizard-design.tsx:2563 📊 WIZARD: rawFloors[ground]?.airEntries length: 1
wizard-design.tsx:2564 📊 WIZARD: fallback airEntries length: 1
wizard-design.tsx:2565 📊 WIZARD: Usando rawAirEntries: SÍ (rawFloors)
wizard-design.tsx:2568 📊 WIZARD: Primer airEntry enviado a Canvas2D - posición: (657.2640263289412, 61.611487914117596)
wizard-design.tsx:2561 📊 WIZARD: Pasando airEntries a Canvas2D
wizard-design.tsx:2562 📊 WIZARD: rawFloors[ground] existe: true
wizard-design.tsx:2563 📊 WIZARD: rawFloors[ground]?.airEntries length: 1
wizard-design.tsx:2564 📊 WIZARD: fallback airEntries length: 1
wizard-design.tsx:2565 📊 WIZARD: Usando rawAirEntries: SÍ (rawFloors)
wizard-design.tsx:2568 📊 WIZARD: Primer airEntry enviado a Canvas2D - posición: (412, 238)
AirEntryDialog.tsx:499 🎯 [SAVE BUTTON CLICKED] AirEntryDialog handleSubmit triggered
AirEntryDialog.tsx:500 🎯 [SAVE BUTTON CLICKED] Event type: submit
AirEntryDialog.tsx:501 🎯 [SAVE BUTTON CLICKED] Props type: vent
AirEntryDialog.tsx:502 🎯 [SAVE BUTTON CLICKED] Current values: {width: 60, height: 40, distanceToFloor: 110, shape: 'rectangular', wallPosition: 50, …}
AirEntryDialog.tsx:503 🎯 [SAVE BUTTON CLICKED] wallPosition from values: 50
AirEntryDialog.tsx:504 🎯 [SAVE BUTTON CLICKED] wallPosition from state: 50
AirEntryDialog.tsx:599 🎯 [PROPS.ONCONFIRM] About to call props.onConfirm with canvasData
AirEntryDialog.tsx:600 🎯 [PROPS.ONCONFIRM] canvasData being sent: {width: 60, height: 40, distanceToFloor: 110, shape: 'rectangular', wallPosition: 50, …}
AirEntryDialog.tsx:601 🎯 [PROPS.ONCONFIRM] canvasData.wallPosition: 50
AirEntryDialog.tsx:602 🎯 [PROPS.ONCONFIRM] canvasData.position: {x: 412, y: 238}
AirEntryDialog.tsx:603 🎯 [PROPS.ONCONFIRM] This should trigger handleAirEntryEdit in Canvas2D
AirEntryDialog.tsx:607 🎯 [PROPS.ONCONFIRM] props.onConfirm completed
AirEntryDialog.tsx:608 🎯 [PROPS.ONCONFIRM] Now calling onClose() to close dialog
wizard-design.tsx:2561 📊 WIZARD: Pasando airEntries a Canvas2D
wizard-design.tsx:2562 📊 WIZARD: rawFloors[ground] existe: true
wizard-design.tsx:2563 📊 WIZARD: rawFloors[ground]?.airEntries length: 1
wizard-design.tsx:2564 📊 WIZARD: fallback airEntries length: 1
wizard-design.tsx:2565 📊 WIZARD: Usando rawAirEntries: SÍ (rawFloors)
wizard-design.tsx:2568 📊 WIZARD: Primer airEntry enviado a Canvas2D - posición: (412, 238)
analytics.ts:62 📊 Analytics Event: {category: 'ui_interaction', action: 'change_tab', label: 'view_3d_preview', value: undefined, status: 'sent'}
Canvas2D.tsx:439 🔗 Canvas2D: Desregistrando suscripción para piso 'ground'
room-store.ts:477 🔗 STORE: Suscripción eliminada. Total listeners: 0
Canvas3D.tsx:1253 🔗 Canvas3D: Registrando suscripción para sincronización de AirEntry en piso 'ground'
room-store.ts:469 🔗 STORE: Nueva suscripción añadida. Total listeners: 1
Canvas3D.tsx:4843 🚨 [SCENE REBUILD TRIGGER] useEffect triggered - dependencies changed
Canvas3D.tsx:4844 🚨 [SCENE REBUILD TRIGGER] floors reference: {ground: {…}}
Canvas3D.tsx:4845 🚨 [SCENE REBUILD TRIGGER] floors identity hash: {"ground":{"lines":[{"id":"1751137688710_hex1ykx9c...
Canvas3D.tsx:4846 🚨 [SCENE REBUILD TRIGGER] currentFloor: ground
Canvas3D.tsx:4847 🚨 [SCENE REBUILD TRIGGER] ceilingHeight: 220
Canvas3D.tsx:4848 🚨 [SCENE REBUILD TRIGGER] floorDeckThickness: 35
Canvas3D.tsx:2406 🔧 [SCENE REBUILD] Creating new material for vent at index 0
Canvas3D.tsx:5381 🔧 [WALL TRANSPARENCY] Updating wall transparency, preserving AirEntry textures
Canvas3D.tsx:5395 🔧 [WALL TRANSPARENCY] Updating wall material opacity to: 0.2
Canvas3D.tsx:5395 🔧 [WALL TRANSPARENCY] Updating wall material opacity to: 0.2
Canvas3D.tsx:5395 🔧 [WALL TRANSPARENCY] Updating wall material opacity to: 0.2
Canvas3D.tsx:5395 🔧 [WALL TRANSPARENCY] Updating wall material opacity to: 0.2
Canvas3D.tsx:5395 🔧 [WALL TRANSPARENCY] Updating wall material opacity to: 0.2
Canvas3D.tsx:5400 ✅ [WALL TRANSPARENCY] Preserving AirEntry material - hasTexture: false opacity: 0.7
chunk-WERSD76P.js?v=cfa7cc5f:18625 [Violation] 'click' handler took 238ms
Canvas3D.tsx:4736 Double-click position search: {airEntryData: {…}, entryPosition: {…}, storedEntryIndex: 0}
Canvas3D.tsx:4746 Double-click found entry using stored entryIndex: 0
Canvas3D.tsx:4774 🔍 [CANVAS3D DOUBLECLICK] baseEntry from store: {type: 'vent', position: {…}, line: {…}, dimensions: {…}}
Canvas3D.tsx:4775 🔍 [CANVAS3D DOUBLECLICK] baseEntry.dimensions: {width: 60, height: 40, distanceToFloor: 110, shape: 'rectangular', wallPosition: 0}
Canvas3D.tsx:4776 🔍 [CANVAS3D DOUBLECLICK] baseEntry.dimensions.wallPosition: 0
Canvas3D.tsx:4781 🔍 [CANVAS3D DOUBLECLICK] updatedData from ref: undefined
Canvas3D.tsx:4788 🔍 [CANVAS3D DOUBLECLICK] mergedEntry: {type: 'vent', position: {…}, line: {…}, dimensions: {…}}
Canvas3D.tsx:4789 🔍 [CANVAS3D DOUBLECLICK] mergedEntry.dimensions.wallPosition: 0
Canvas3D.tsx:4800 🔍 [CANVAS3D DOUBLECLICK] Dialog opening with index: 0
Canvas3D.tsx:1428 🏠 [AIRENTRY DIRECT] Updating position directly for vent - similar to furniture
Canvas3D.tsx:1432 ✅ [AIRENTRY DIRECT] Position updated directly - Material: MeshPhongMaterial, HasTexture: false
Canvas3D.tsx:1440 🔍 [HYPOTHESIS TEST] About to call onUpdateAirEntry - this may trigger floors modification
Canvas3D.tsx:1441 🔍 [HYPOTHESIS TEST] Current floors object reference: object
wizard-design.tsx:1113 🎯 WIZARD: handleUpdateAirEntryFrom3D llamado - piso: ground, índice: 0
wizard-design.tsx:1114 🎯 WIZARD: Datos recibidos del AirEntry: {type: 'vent', position: {…}, line: {…}, dimensions: {…}}
wizard-design.tsx:1131 📝 WIZARD: Entry clonado con wallPosition preservado: {type: 'vent', position: {…}, line: {…}, dimensions: {…}}
wizard-design.tsx:1135 ✅ WIZARD: Actualizando piso actual - procediendo con la actualización del store
wizard-design.tsx:1144 📋 WIZARD: setAirEntries ejecutado con nuevo array
wizard-design.tsx:1155 📋 WIZARD: useRoomStore.setFloors ejecutado
wizard-design.tsx:1159 🚨 WIZARD: CRÍTICO - No se está llamando updateAirEntry del store para la sincronización
wizard-design.tsx:1160 🚨 WIZARD: Esto explica por qué no se notifica a otros componentes
wizard-design.tsx:1163 🔧 WIZARD: Llamando updateAirEntry para disparar sincronización
room-store.ts:425 🔄 STORE: updateAirEntry llamado - piso: ground, índice: 0
room-store.ts:426 🔄 STORE: Nueva posición del AirEntry: (679.065273113736, 45.93250906203916)
room-store.ts:440 ✅ STORE: AirEntry actualizado en el store, notificando a 1 listeners
room-store.ts:444 📢 STORE: Notificando listener 1/1
Canvas3D.tsx:1256 📥 Canvas3D: Recibida notificación de cambio AirEntry - piso: ground, índice: 0
Canvas3D.tsx:1257 📥 Canvas3D: Tipo: vent, posición: (679.065273113736, 45.93250906203916)
Canvas3D.tsx:1265 ✅ Canvas3D: Aplicando cambio - buscando objetos en escena 3D
Canvas3D.tsx:1278 🎯 Canvas3D: Encontrado objeto vent para actualizar - índice: 0
Canvas3D.tsx:1285 🎯 Canvas3D: Objeto actualizado - nueva posición 3D: (348.83159139217, 317.58436367245105, 110)
Canvas3D.tsx:1289 📊 Canvas3D: Objetos encontrados: 1, actualizados: 1
Canvas3D.tsx:1293 🔄 Canvas3D: Forzando re-render de la escena
Canvas3D.tsx:1256 📥 Canvas3D: Recibida notificación de cambio AirEntry - piso: ground, índice: 0
Canvas3D.tsx:1257 📥 Canvas3D: Tipo: vent, posición: (679.065273113736, 45.93250906203916)
Canvas3D.tsx:1265 ✅ Canvas3D: Aplicando cambio - buscando objetos en escena 3D
Canvas3D.tsx:1278 🎯 Canvas3D: Encontrado objeto vent para actualizar - índice: 0
Canvas3D.tsx:1285 🎯 Canvas3D: Objeto actualizado - nueva posición 3D: (348.83159139217, 317.58436367245105, 110)
Canvas3D.tsx:1289 📊 Canvas3D: Objetos encontrados: 1, actualizados: 1
Canvas3D.tsx:1293 🔄 Canvas3D: Forzando re-render de la escena
wizard-design.tsx:1165 ✅ WIZARD: updateAirEntry completado - debería notificar a Canvas2D, Canvas3D y RSP
Canvas3D.tsx:1443 🔍 [HYPOTHESIS TEST] onUpdateAirEntry completed - floors may have been modified
Canvas3D.tsx:1447 ✅ [OPTIMIZATION] Position update complete - textures preserved automatically
Canvas3D.tsx:1428 🏠 [AIRENTRY DIRECT] Updating position directly for vent - similar to furniture
Canvas3D.tsx:1432 ✅ [AIRENTRY DIRECT] Position updated directly - Material: MeshPhongMaterial, HasTexture: false
Canvas3D.tsx:1428 🏠 [AIRENTRY DIRECT] Updating position directly for vent - similar to furniture
Canvas3D.tsx:1432 ✅ [AIRENTRY DIRECT] Position updated directly - Material: MeshPhongMaterial, HasTexture: false
Canvas3D.tsx:1440 🔍 [HYPOTHESIS TEST] About to call onUpdateAirEntry - this may trigger floors modification
Canvas3D.tsx:1441 🔍 [HYPOTHESIS TEST] Current floors object reference: object
wizard-design.tsx:1113 🎯 WIZARD: handleUpdateAirEntryFrom3D llamado - piso: ground, índice: 0
wizard-design.tsx:1114 🎯 WIZARD: Datos recibidos del AirEntry: {type: 'vent', position: {…}, line: {…}, dimensions: {…}}
wizard-design.tsx:1131 📝 WIZARD: Entry clonado con wallPosition preservado: {type: 'vent', position: {…}, line: {…}, dimensions: {…}}
wizard-design.tsx:1135 ✅ WIZARD: Actualizando piso actual - procediendo con la actualización del store
wizard-design.tsx:1144 📋 WIZARD: setAirEntries ejecutado con nuevo array
wizard-design.tsx:1155 📋 WIZARD: useRoomStore.setFloors ejecutado
wizard-design.tsx:1159 🚨 WIZARD: CRÍTICO - No se está llamando updateAirEntry del store para la sincronización
wizard-design.tsx:1160 🚨 WIZARD: Esto explica por qué no se notifica a otros componentes
wizard-design.tsx:1163 🔧 WIZARD: Llamando updateAirEntry para disparar sincronización
room-store.ts:425 🔄 STORE: updateAirEntry llamado - piso: ground, índice: 0
room-store.ts:426 🔄 STORE: Nueva posición del AirEntry: (139.4844151900653, 433.98723565098044)
room-store.ts:440 ✅ STORE: AirEntry actualizado en el store, notificando a 1 listeners
room-store.ts:444 📢 STORE: Notificando listener 1/1
Canvas3D.tsx:1256 📥 Canvas3D: Recibida notificación de cambio AirEntry - piso: ground, índice: 0
Canvas3D.tsx:1257 📥 Canvas3D: Tipo: vent, posición: (139.4844151900653, 433.98723565098044)
Canvas3D.tsx:1265 ✅ Canvas3D: Aplicando cambio - buscando objetos en escena 3D
Canvas3D.tsx:1278 🎯 Canvas3D: Encontrado objeto vent para actualizar - índice: 0
Canvas3D.tsx:1285 🎯 Canvas3D: Objeto actualizado - nueva posición 3D: (-325.6444810124184, -167.48404456372555, 110)
Canvas3D.tsx:1289 📊 Canvas3D: Objetos encontrados: 1, actualizados: 1
Canvas3D.tsx:1293 🔄 Canvas3D: Forzando re-render de la escena
Canvas3D.tsx:1256 📥 Canvas3D: Recibida notificación de cambio AirEntry - piso: ground, índice: 0
Canvas3D.tsx:1257 📥 Canvas3D: Tipo: vent, posición: (139.4844151900653, 433.98723565098044)
Canvas3D.tsx:1265 ✅ Canvas3D: Aplicando cambio - buscando objetos en escena 3D
Canvas3D.tsx:1278 🎯 Canvas3D: Encontrado objeto vent para actualizar - índice: 0
Canvas3D.tsx:1285 🎯 Canvas3D: Objeto actualizado - nueva posición 3D: (-325.6444810124184, -167.48404456372555, 110)
Canvas3D.tsx:1289 📊 Canvas3D: Objetos encontrados: 1, actualizados: 1
Canvas3D.tsx:1293 🔄 Canvas3D: Forzando re-render de la escena
wizard-design.tsx:1165 ✅ WIZARD: updateAirEntry completado - debería notificar a Canvas2D, Canvas3D y RSP
Canvas3D.tsx:1443 🔍 [HYPOTHESIS TEST] onUpdateAirEntry completed - floors may have been modified
Canvas3D.tsx:1447 ✅ [OPTIMIZATION] Position update complete - textures preserved automatically
AirEntryDialog.tsx:499 🎯 [SAVE BUTTON CLICKED] AirEntryDialog handleSubmit triggered
AirEntryDialog.tsx:500 🎯 [SAVE BUTTON CLICKED] Event type: submit
AirEntryDialog.tsx:501 🎯 [SAVE BUTTON CLICKED] Props type: vent
AirEntryDialog.tsx:502 🎯 [SAVE BUTTON CLICKED] Current values: {width: 60, height: 40, distanceToFloor: 110, shape: 'rectangular', wallPosition: 100, …}
AirEntryDialog.tsx:503 🎯 [SAVE BUTTON CLICKED] wallPosition from values: 100
AirEntryDialog.tsx:504 🎯 [SAVE BUTTON CLICKED] wallPosition from state: 100
AirEntryDialog.tsx:599 🎯 [PROPS.ONCONFIRM] About to call props.onConfirm with canvasData
AirEntryDialog.tsx:600 🎯 [PROPS.ONCONFIRM] canvasData being sent: {width: 60, height: 40, distanceToFloor: 110, shape: 'rectangular', wallPosition: 100, …}
AirEntryDialog.tsx:601 🎯 [PROPS.ONCONFIRM] canvasData.wallPosition: 100
AirEntryDialog.tsx:602 🎯 [PROPS.ONCONFIRM] canvasData.position: {x: 139.4844151900653, y: 433.98723565098044}
AirEntryDialog.tsx:603 🎯 [PROPS.ONCONFIRM] This should trigger handleAirEntryEdit in Canvas2D
Canvas3D.tsx:6091 [CANVAS3D ONCONFIRM] Received data from dialog: {width: 60, height: 40, distanceToFloor: 110, shape: 'rectangular', wallPosition: 100, …}
Canvas3D.tsx:6092 [CANVAS3D ONCONFIRM] wallPosition in received data: 100
Canvas3D.tsx:6093 🔍 [SAVE CHANGES DEBUG] About to call handleAirEntryEdit
Canvas3D.tsx:1880 🔍 [CANVAS3D handleAirEntryEdit] Called with index: 0
Canvas3D.tsx:1881 🔍 [CANVAS3D handleAirEntryEdit] Received data: {width: 60, height: 40, distanceToFloor: 110, shape: 'rectangular', wallPosition: 100, …}
Canvas3D.tsx:1882 🔍 [CANVAS3D handleAirEntryEdit] data.wallPosition: 100
Canvas3D.tsx:1921 🚀 Canvas3D: Llamando onUpdateAirEntry - piso: ground, índice: 0
Canvas3D.tsx:1922 🚀 Canvas3D: Datos del AirEntry actualizado: {type: 'vent', position: {…}, line: {…}, dimensions: {…}, properties: {…}}
wizard-design.tsx:1113 🎯 WIZARD: handleUpdateAirEntryFrom3D llamado - piso: ground, índice: 0
wizard-design.tsx:1114 🎯 WIZARD: Datos recibidos del AirEntry: {type: 'vent', position: {…}, line: {…}, dimensions: {…}, properties: {…}}
wizard-design.tsx:1131 📝 WIZARD: Entry clonado con wallPosition preservado: {type: 'vent', position: {…}, line: {…}, dimensions: {…}, properties: {…}}
wizard-design.tsx:1135 ✅ WIZARD: Actualizando piso actual - procediendo con la actualización del store
wizard-design.tsx:1144 📋 WIZARD: setAirEntries ejecutado con nuevo array
wizard-design.tsx:1155 📋 WIZARD: useRoomStore.setFloors ejecutado
wizard-design.tsx:1159 🚨 WIZARD: CRÍTICO - No se está llamando updateAirEntry del store para la sincronización
wizard-design.tsx:1160 🚨 WIZARD: Esto explica por qué no se notifica a otros componentes
wizard-design.tsx:1163 🔧 WIZARD: Llamando updateAirEntry para disparar sincronización
room-store.ts:425 🔄 STORE: updateAirEntry llamado - piso: ground, índice: 0
room-store.ts:426 🔄 STORE: Nueva posición del AirEntry: (139.4844151900653, 433.98723565098044)
room-store.ts:440 ✅ STORE: AirEntry actualizado en el store, notificando a 1 listeners
room-store.ts:444 📢 STORE: Notificando listener 1/1
Canvas3D.tsx:1256 📥 Canvas3D: Recibida notificación de cambio AirEntry - piso: ground, índice: 0
Canvas3D.tsx:1257 📥 Canvas3D: Tipo: vent, posición: (139.4844151900653, 433.98723565098044)
Canvas3D.tsx:1265 ✅ Canvas3D: Aplicando cambio - buscando objetos en escena 3D
Canvas3D.tsx:1278 🎯 Canvas3D: Encontrado objeto vent para actualizar - índice: 0
Canvas3D.tsx:1285 🎯 Canvas3D: Objeto actualizado - nueva posición 3D: (-325.6444810124184, -167.48404456372555, 110)
Canvas3D.tsx:1289 📊 Canvas3D: Objetos encontrados: 1, actualizados: 1
Canvas3D.tsx:1293 🔄 Canvas3D: Forzando re-render de la escena
Canvas3D.tsx:1256 📥 Canvas3D: Recibida notificación de cambio AirEntry - piso: ground, índice: 0
Canvas3D.tsx:1257 📥 Canvas3D: Tipo: vent, posición: (139.4844151900653, 433.98723565098044)
Canvas3D.tsx:1265 ✅ Canvas3D: Aplicando cambio - buscando objetos en escena 3D
Canvas3D.tsx:1278 🎯 Canvas3D: Encontrado objeto vent para actualizar - índice: 0
Canvas3D.tsx:1285 🎯 Canvas3D: Objeto actualizado - nueva posición 3D: (-325.6444810124184, -167.48404456372555, 110)
Canvas3D.tsx:1289 📊 Canvas3D: Objetos encontrados: 1, actualizados: 1
Canvas3D.tsx:1293 🔄 Canvas3D: Forzando re-render de la escena
wizard-design.tsx:1165 ✅ WIZARD: updateAirEntry completado - debería notificar a Canvas2D, Canvas3D y RSP
Canvas3D.tsx:1926 ✅ Canvas3D: onUpdateAirEntry completado - debería haber actualizado el store
Canvas3D.tsx:1927 📋 Canvas3D: Verificando si esto dispara notificaciones a otros componentes...
Canvas3D.tsx:1939 🔍 [BEFORE CLOSE] Mesh 0 material: {hasMap: false, opacity: 0.7, type: 'vent'}
Canvas3D.tsx:1947 🔬 [DEPENDENCY TRACKING] BEFORE setEditingAirEntry(null):
Canvas3D.tsx:1948 🔬 [DEPENDENCY TRACKING] floors keys: ['ground']
Canvas3D.tsx:1949 🔬 [DEPENDENCY TRACKING] currentFloor: ground
Canvas3D.tsx:1950 🔬 [DEPENDENCY TRACKING] ceilingHeight: 220
Canvas3D.tsx:1951 🔬 [DEPENDENCY TRACKING] floorDeckThickness: 35
Canvas3D.tsx:1952 🔬 [DEPENDENCY TRACKING] floors[currentFloor] airEntries length: 1
Canvas3D.tsx:1953 🔬 [DEPENDENCY TRACKING] selectedAirEntry state: NULL
Canvas3D.tsx:1957 🔬 [DEPENDENCY TRACKING] AFTER setEditingAirEntry(null):
Canvas3D.tsx:1958 🔬 [DEPENDENCY TRACKING] floors keys: ['ground']
Canvas3D.tsx:1959 🔬 [DEPENDENCY TRACKING] currentFloor: ground
Canvas3D.tsx:1960 🔬 [DEPENDENCY TRACKING] ceilingHeight: 220
Canvas3D.tsx:1961 🔬 [DEPENDENCY TRACKING] floorDeckThickness: 35
Canvas3D.tsx:1962 🔬 [DEPENDENCY TRACKING] floors[currentFloor] airEntries length: 1
Canvas3D.tsx:1963 🔬 [DEPENDENCY TRACKING] selectedAirEntry state: NULL
Canvas3D.tsx:1986 ✅ [SAVE CHANGES] Data commit complete - monitoring for texture loss
Canvas3D.tsx:1987 ✅ [SAVE CHANGES] Dialog closed - checking for side effects
Canvas3D.tsx:6102 🔍 [SAVE CHANGES DEBUG] handleAirEntryEdit completed - checking for side effects
AirEntryDialog.tsx:607 🎯 [PROPS.ONCONFIRM] props.onConfirm completed
AirEntryDialog.tsx:608 🎯 [PROPS.ONCONFIRM] Now calling onClose() to close dialog
Canvas3D.tsx:1967 🔍 [AFTER CLOSE] Checking textures immediately after dialog close
Canvas3D.tsx:1977 🔍 [AFTER CLOSE] Mesh 0 material: {hasMap: false, opacity: 0.7, type: 'vent'}
Canvas3D.tsx:6106 🔍 [SAVE CHANGES DEBUG] 100ms after Save Changes - checking scene state
Canvas3D.tsx:6114 🔍 [SAVE CHANGES DEBUG] AirEntry meshes found: 1
Canvas3D.tsx:6117 🔍 [SAVE CHANGES DEBUG] Mesh 0 material: {hasMap: false, opacity: 0.7, type: 'vent'}
analytics.ts:62 📊 Analytics Event: {category: 'ui_interaction', action: 'change_tab', label: 'view_2d_editor', value: undefined, status: 'sent'}
wizard-design.tsx:2561 📊 WIZARD: Pasando airEntries a Canvas2D
wizard-design.tsx:2562 📊 WIZARD: rawFloors[ground] existe: true
wizard-design.tsx:2563 📊 WIZARD: rawFloors[ground]?.airEntries length: 1
wizard-design.tsx:2564 📊 WIZARD: fallback airEntries length: 1
wizard-design.tsx:2565 📊 WIZARD: Usando rawAirEntries: SÍ (rawFloors)
wizard-design.tsx:2568 📊 WIZARD: Primer airEntry enviado a Canvas2D - posición: (139.4844151900653, 433.98723565098044)
Canvas3D.tsx:1300 🔗 Canvas3D: Desregistrando suscripción para piso 'ground'
room-store.ts:477 🔗 STORE: Suscripción eliminada. Total listeners: 0
Canvas2D.tsx:408 🔗 Canvas2D: Registrando suscripción para piso 'ground'
Canvas2D.tsx:409 🔗 Canvas2D: subscribeToAirEntryChanges función disponible: true
room-store.ts:469 🔗 STORE: Nueva suscripción añadida. Total listeners: 1
Canvas2D.tsx:436 🔗 Canvas2D: Suscripción creada exitosamente: true
wizard-design.tsx:2561 📊 WIZARD: Pasando airEntries a Canvas2D
wizard-design.tsx:2562 📊 WIZARD: rawFloors[ground] existe: true
wizard-design.tsx:2563 📊 WIZARD: rawFloors[ground]?.airEntries length: 1
wizard-design.tsx:2564 📊 WIZARD: fallback airEntries length: 1
wizard-design.tsx:2565 📊 WIZARD: Usando rawAirEntries: SÍ (rawFloors)
wizard-design.tsx:2568 📊 WIZARD: Primer airEntry enviado a Canvas2D - posición: (139.4844151900653, 433.98723565098044)
wizard-design:1 [.WebGL-0x2c6408c7c700] GL_INVALID_OPERATION: Texture is immutable.
wizard-design:1 [.WebGL-0x2c6408c7c700] GL_INVALID_OPERATION: Texture is immutable.
wizard-design:1 [.WebGL-0x2c6408c7c700] GL_INVALID_OPERATION: Texture is immutable.
wizard-design:1 [.WebGL-0x2c6408c7c700] GL_INVALID_OPERATION: Texture is immutable.
wizard-design.tsx:2561 📊 WIZARD: Pasando airEntries a Canvas2D
wizard-design.tsx:2562 📊 WIZARD: rawFloors[ground] existe: true
wizard-design.tsx:2563 📊 WIZARD: rawFloors[ground]?.airEntries length: 1
wizard-design.tsx:2564 📊 WIZARD: fallback airEntries length: 1
wizard-design.tsx:2565 📊 WIZARD: Usando rawAirEntries: SÍ (rawFloors)
wizard-design.tsx:2568 📊 WIZARD: Primer airEntry enviado a Canvas2D - posición: (139.4844151900653, 433.98723565098044)
wizard-design.tsx:2561 📊 WIZARD: Pasando airEntries a Canvas2D
wizard-design.tsx:2562 📊 WIZARD: rawFloors[ground] existe: true
wizard-design.tsx:2563 📊 WIZARD: rawFloors[ground]?.airEntries length: 1
wizard-design.tsx:2564 📊 WIZARD: fallback airEntries length: 1
wizard-design.tsx:2565 📊 WIZARD: Usando rawAirEntries: SÍ (rawFloors)
wizard-design.tsx:2568 📊 WIZARD: Primer airEntry enviado a Canvas2D - posición: (139.4844151900653, 433.98723565098044)
wizard-design.tsx:2561 📊 WIZARD: Pasando airEntries a Canvas2D
wizard-design.tsx:2562 📊 WIZARD: rawFloors[ground] existe: true
wizard-design.tsx:2563 📊 WIZARD: rawFloors[ground]?.airEntries length: 1
wizard-design.tsx:2564 📊 WIZARD: fallback airEntries length: 1
wizard-design.tsx:2565 📊 WIZARD: Usando rawAirEntries: SÍ (rawFloors)
wizard-design.tsx:2568 📊 WIZARD: Primer airEntry enviado a Canvas2D - posición: (139.4844151900653, 433.98723565098044)
wizard-design.tsx:2561 📊 WIZARD: Pasando airEntries a Canvas2D
wizard-design.tsx:2562 📊 WIZARD: rawFloors[ground] existe: true
wizard-design.tsx:2563 📊 WIZARD: rawFloors[ground]?.airEntries length: 1
wizard-design.tsx:2564 📊 WIZARD: fallback airEntries length: 1
wizard-design.tsx:2565 📊 WIZARD: Usando rawAirEntries: SÍ (rawFloors)
wizard-design.tsx:2568 📊 WIZARD: Primer airEntry enviado a Canvas2D - posición: (657.2640263289412, 61.611487914117596)
wizard-design.tsx:2561 📊 WIZARD: Pasando airEntries a Canvas2D
wizard-design.tsx:2562 📊 WIZARD: rawFloors[ground] existe: true
wizard-design.tsx:2563 📊 WIZARD: rawFloors[ground]?.airEntries length: 1
wizard-design.tsx:2564 📊 WIZARD: fallback airEntries length: 1
wizard-design.tsx:2565 📊 WIZARD: Usando rawAirEntries: SÍ (rawFloors)
wizard-design.tsx:2568 📊 WIZARD: Primer airEntry enviado a Canvas2D - posición: (412, 238)
AirEntryDialog.tsx:499 🎯 [SAVE BUTTON CLICKED] AirEntryDialog handleSubmit triggered
AirEntryDialog.tsx:500 🎯 [SAVE BUTTON CLICKED] Event type: submit
AirEntryDialog.tsx:501 🎯 [SAVE BUTTON CLICKED] Props type: vent
AirEntryDialog.tsx:502 🎯 [SAVE BUTTON CLICKED] Current values: {width: 60, height: 40, distanceToFloor: 110, shape: 'rectangular', wallPosition: 50, …}
AirEntryDialog.tsx:503 🎯 [SAVE BUTTON CLICKED] wallPosition from values: 50
AirEntryDialog.tsx:504 🎯 [SAVE BUTTON CLICKED] wallPosition from state: 50
AirEntryDialog.tsx:599 🎯 [PROPS.ONCONFIRM] About to call props.onConfirm with canvasData
AirEntryDialog.tsx:600 🎯 [PROPS.ONCONFIRM] canvasData being sent: {width: 60, height: 40, distanceToFloor: 110, shape: 'rectangular', wallPosition: 50, …}
AirEntryDialog.tsx:601 🎯 [PROPS.ONCONFIRM] canvasData.wallPosition: 50
AirEntryDialog.tsx:602 🎯 [PROPS.ONCONFIRM] canvasData.position: {x: 412, y: 238}
AirEntryDialog.tsx:603 🎯 [PROPS.ONCONFIRM] This should trigger handleAirEntryEdit in Canvas2D
AirEntryDialog.tsx:607 🎯 [PROPS.ONCONFIRM] props.onConfirm completed
AirEntryDialog.tsx:608 🎯 [PROPS.ONCONFIRM] Now calling onClose() to close dialog
wizard-design.tsx:2561 📊 WIZARD: Pasando airEntries a Canvas2D
wizard-design.tsx:2562 📊 WIZARD: rawFloors[ground] existe: true
wizard-design.tsx:2563 📊 WIZARD: rawFloors[ground]?.airEntries length: 1
wizard-design.tsx:2564 📊 WIZARD: fallback airEntries length: 1
wizard-design.tsx:2565 📊 WIZARD: Usando rawAirEntries: SÍ (rawFloors)
wizard-design.tsx:2568 📊 WIZARD: Primer airEntry enviado a Canvas2D - posición: (412, 238)
analytics.ts:62 📊 Analytics Event: {category: 'ui_interaction', action: 'change_tab', label: 'view_3d_preview', value: undefined, status: 'sent'}
Canvas2D.tsx:439 🔗 Canvas2D: Desregistrando suscripción para piso 'ground'
room-store.ts:477 🔗 STORE: Suscripción eliminada. Total listeners: 0
Canvas3D.tsx:1253 🔗 Canvas3D: Registrando suscripción para sincronización de AirEntry en piso 'ground'
room-store.ts:469 🔗 STORE: Nueva suscripción añadida. Total listeners: 1
Canvas3D.tsx:4843 🚨 [SCENE REBUILD TRIGGER] useEffect triggered - dependencies changed
Canvas3D.tsx:4844 🚨 [SCENE REBUILD TRIGGER] floors reference: {ground: {…}}
Canvas3D.tsx:4845 🚨 [SCENE REBUILD TRIGGER] floors identity hash: {"ground":{"lines":[{"id":"1751137688710_hex1ykx9c...
Canvas3D.tsx:4846 🚨 [SCENE REBUILD TRIGGER] currentFloor: ground
Canvas3D.tsx:4847 🚨 [SCENE REBUILD TRIGGER] ceilingHeight: 220
Canvas3D.tsx:4848 🚨 [SCENE REBUILD TRIGGER] floorDeckThickness: 35
Canvas3D.tsx:2406 🔧 [SCENE REBUILD] Creating new material for vent at index 0
Canvas3D.tsx:5381 🔧 [WALL TRANSPARENCY] Updating wall transparency, preserving AirEntry textures
Canvas3D.tsx:5395 🔧 [WALL TRANSPARENCY] Updating wall material opacity to: 0.2
Canvas3D.tsx:5395 🔧 [WALL TRANSPARENCY] Updating wall material opacity to: 0.2
Canvas3D.tsx:5395 🔧 [WALL TRANSPARENCY] Updating wall material opacity to: 0.2
Canvas3D.tsx:5395 🔧 [WALL TRANSPARENCY] Updating wall material opacity to: 0.2
Canvas3D.tsx:5395 🔧 [WALL TRANSPARENCY] Updating wall material opacity to: 0.2
Canvas3D.tsx:5400 ✅ [WALL TRANSPARENCY] Preserving AirEntry material - hasTexture: false opacity: 0.7
chunk-WERSD76P.js?v=cfa7cc5f:18625 [Violation] 'click' handler took 326ms
analytics.ts:62 📊 Analytics Event: {category: 'ui_interaction', action: 'change_tab', label: 'view_2d_editor', value: undefined, status: 'sent'}
wizard-design.tsx:2561 📊 WIZARD: Pasando airEntries a Canvas2D
wizard-design.tsx:2562 📊 WIZARD: rawFloors[ground] existe: true
wizard-design.tsx:2563 📊 WIZARD: rawFloors[ground]?.airEntries length: 1
wizard-design.tsx:2564 📊 WIZARD: fallback airEntries length: 1
wizard-design.tsx:2565 📊 WIZARD: Usando rawAirEntries: SÍ (rawFloors)
wizard-design.tsx:2568 📊 WIZARD: Primer airEntry enviado a Canvas2D - posición: (412, 238)
Canvas3D.tsx:1300 🔗 Canvas3D: Desregistrando suscripción para piso 'ground'
room-store.ts:477 🔗 STORE: Suscripción eliminada. Total listeners: 0
Canvas2D.tsx:408 🔗 Canvas2D: Registrando suscripción para piso 'ground'
Canvas2D.tsx:409 🔗 Canvas2D: subscribeToAirEntryChanges función disponible: true
room-store.ts:469 🔗 STORE: Nueva suscripción añadida. Total listeners: 1
Canvas2D.tsx:436 🔗 Canvas2D: Suscripción creada exitosamente: true
wizard-design.tsx:2561 📊 WIZARD: Pasando airEntries a Canvas2D
wizard-design.tsx:2562 📊 WIZARD: rawFloors[ground] existe: true
wizard-design.tsx:2563 📊 WIZARD: rawFloors[ground]?.airEntries length: 1
wizard-design.tsx:2564 📊 WIZARD: fallback airEntries length: 1
wizard-design.tsx:2565 📊 WIZARD: Usando rawAirEntries: SÍ (rawFloors)
wizard-design.tsx:2568 📊 WIZARD: Primer airEntry enviado a Canvas2D - posición: (412, 238)
wizard-design:1 [.WebGL-0x2c64126fe200] GL_INVALID_OPERATION: Texture is immutable.
wizard-design:1 [.WebGL-0x2c64126fe200] GL_INVALID_OPERATION: Texture is immutable.
wizard-design:1 [.WebGL-0x2c64126fe200] GL_INVALID_OPERATION: Texture is immutable.
wizard-design:1 [.WebGL-0x2c64126fe200] GL_INVALID_OPERATION: Texture is immutable.
analytics.ts:62 📊 Analytics Event: {category: 'ui_interaction', action: 'change_tab', label: 'view_3d_preview', value: undefined, status: 'sent'}
Canvas2D.tsx:439 🔗 Canvas2D: Desregistrando suscripción para piso 'ground'
room-store.ts:477 🔗 STORE: Suscripción eliminada. Total listeners: 0
Canvas3D.tsx:1253 🔗 Canvas3D: Registrando suscripción para sincronización de AirEntry en piso 'ground'
room-store.ts:469 🔗 STORE: Nueva suscripción añadida. Total listeners: 1
Canvas3D.tsx:4843 🚨 [SCENE REBUILD TRIGGER] useEffect triggered - dependencies changed
Canvas3D.tsx:4844 🚨 [SCENE REBUILD TRIGGER] floors reference: {ground: {…}}
Canvas3D.tsx:4845 🚨 [SCENE REBUILD TRIGGER] floors identity hash: {"ground":{"lines":[{"id":"1751137688710_hex1ykx9c...
Canvas3D.tsx:4846 🚨 [SCENE REBUILD TRIGGER] currentFloor: ground
Canvas3D.tsx:4847 🚨 [SCENE REBUILD TRIGGER] ceilingHeight: 220
Canvas3D.tsx:4848 🚨 [SCENE REBUILD TRIGGER] floorDeckThickness: 35
Canvas3D.tsx:2406 🔧 [SCENE REBUILD] Creating new material for vent at index 0
Canvas3D.tsx:5381 🔧 [WALL TRANSPARENCY] Updating wall transparency, preserving AirEntry textures
Canvas3D.tsx:5395 🔧 [WALL TRANSPARENCY] Updating wall material opacity to: 0.2
Canvas3D.tsx:5395 🔧 [WALL TRANSPARENCY] Updating wall material opacity to: 0.2
Canvas3D.tsx:5395 🔧 [WALL TRANSPARENCY] Updating wall material opacity to: 0.2
Canvas3D.tsx:5395 🔧 [WALL TRANSPARENCY] Updating wall material opacity to: 0.2
Canvas3D.tsx:5395 🔧 [WALL TRANSPARENCY] Updating wall material opacity to: 0.2
Canvas3D.tsx:5400 ✅ [WALL TRANSPARENCY] Preserving AirEntry material - hasTexture: false opacity: 0.7
analytics.ts:62 📊 Analytics Event: {category: 'ui_interaction', action: 'change_tab', label: 'view_2d_editor', value: undefined, status: 'sent'}
wizard-design.tsx:2561 📊 WIZARD: Pasando airEntries a Canvas2D
wizard-design.tsx:2562 📊 WIZARD: rawFloors[ground] existe: true
wizard-design.tsx:2563 📊 WIZARD: rawFloors[ground]?.airEntries length: 1
wizard-design.tsx:2564 📊 WIZARD: fallback airEntries length: 1
wizard-design.tsx:2565 📊 WIZARD: Usando rawAirEntries: SÍ (rawFloors)
wizard-design.tsx:2568 📊 WIZARD: Primer airEntry enviado a Canvas2D - posición: (412, 238)
Canvas3D.tsx:1300 🔗 Canvas3D: Desregistrando suscripción para piso 'ground'
room-store.ts:477 🔗 STORE: Suscripción eliminada. Total listeners: 0
Canvas2D.tsx:408 🔗 Canvas2D: Registrando suscripción para piso 'ground'
Canvas2D.tsx:409 🔗 Canvas2D: subscribeToAirEntryChanges función disponible: true
room-store.ts:469 🔗 STORE: Nueva suscripción añadida. Total listeners: 1
Canvas2D.tsx:436 🔗 Canvas2D: Suscripción creada exitosamente: true
wizard-design.tsx:2561 📊 WIZARD: Pasando airEntries a Canvas2D
wizard-design.tsx:2562 📊 WIZARD: rawFloors[ground] existe: true
wizard-design.tsx:2563 📊 WIZARD: rawFloors[ground]?.airEntries length: 1
wizard-design.tsx:2564 📊 WIZARD: fallback airEntries length: 1
wizard-design.tsx:2565 📊 WIZARD: Usando rawAirEntries: SÍ (rawFloors)
wizard-design.tsx:2568 📊 WIZARD: Primer airEntry enviado a Canvas2D - posición: (412, 238)
wizard-design:1 [.WebGL-0x2c640ebdbf00] GL_INVALID_OPERATION: Texture is immutable.
wizard-design:1 [.WebGL-0x2c640ebdbf00] GL_INVALID_OPERATION: Texture is immutable.
wizard-design:1 [.WebGL-0x2c640ebdbf00] GL_INVALID_OPERATION: Texture is immutable.
wizard-design:1 [.WebGL-0x2c640ebdbf00] GL_INVALID_OPERATION: Texture is immutable.
analytics.ts:62 📊 Analytics Event: {category: 'ui_interaction', action: 'change_tab', label: 'view_3d_preview', value: undefined, status: 'sent'}
Canvas2D.tsx:439 🔗 Canvas2D: Desregistrando suscripción para piso 'ground'
room-store.ts:477 🔗 STORE: Suscripción eliminada. Total listeners: 0
Canvas3D.tsx:1253 🔗 Canvas3D: Registrando suscripción para sincronización de AirEntry en piso 'ground'
room-store.ts:469 🔗 STORE: Nueva suscripción añadida. Total listeners: 1
Canvas3D.tsx:4843 🚨 [SCENE REBUILD TRIGGER] useEffect triggered - dependencies changed
Canvas3D.tsx:4844 🚨 [SCENE REBUILD TRIGGER] floors reference: {ground: {…}}
Canvas3D.tsx:4845 🚨 [SCENE REBUILD TRIGGER] floors identity hash: {"ground":{"lines":[{"id":"1751137688710_hex1ykx9c...
Canvas3D.tsx:4846 🚨 [SCENE REBUILD TRIGGER] currentFloor: ground
Canvas3D.tsx:4847 🚨 [SCENE REBUILD TRIGGER] ceilingHeight: 220
Canvas3D.tsx:4848 🚨 [SCENE REBUILD TRIGGER] floorDeckThickness: 35
Canvas3D.tsx:2406 🔧 [SCENE REBUILD] Creating new material for vent at index 0
Canvas3D.tsx:5381 🔧 [WALL TRANSPARENCY] Updating wall transparency, preserving AirEntry textures
Canvas3D.tsx:5395 🔧 [WALL TRANSPARENCY] Updating wall material opacity to: 0.2
Canvas3D.tsx:5395 🔧 [WALL TRANSPARENCY] Updating wall material opacity to: 0.2
Canvas3D.tsx:5395 🔧 [WALL TRANSPARENCY] Updating wall material opacity to: 0.2
Canvas3D.tsx:5395 🔧 [WALL TRANSPARENCY] Updating wall material opacity to: 0.2
Canvas3D.tsx:5395 🔧 [WALL TRANSPARENCY] Updating wall material opacity to: 0.2
Canvas3D.tsx:5400 ✅ [WALL TRANSPARENCY] Preserving AirEntry material - hasTexture: false opacity: 0.7
chunk-WERSD76P.js?v=cfa7cc5f:18625 [Violation] 'click' handler took 171ms
Canvas3D.tsx:4736 Double-click position search: {airEntryData: {…}, entryPosition: {…}, storedEntryIndex: 0}
Canvas3D.tsx:4746 Double-click found entry using stored entryIndex: 0
Canvas3D.tsx:4774 🔍 [CANVAS3D DOUBLECLICK] baseEntry from store: {type: 'vent', position: {…}, line: {…}, dimensions: {…}}
Canvas3D.tsx:4775 🔍 [CANVAS3D DOUBLECLICK] baseEntry.dimensions: {width: 60, height: 40, distanceToFloor: 110, shape: 'rectangular', wallPosition: 0}
Canvas3D.tsx:4776 🔍 [CANVAS3D DOUBLECLICK] baseEntry.dimensions.wallPosition: 0
Canvas3D.tsx:4781 🔍 [CANVAS3D DOUBLECLICK] updatedData from ref: undefined
Canvas3D.tsx:4788 🔍 [CANVAS3D DOUBLECLICK] mergedEntry: {type: 'vent', position: {…}, line: {…}, dimensions: {…}}
Canvas3D.tsx:4789 🔍 [CANVAS3D DOUBLECLICK] mergedEntry.dimensions.wallPosition: 0
Canvas3D.tsx:4800 🔍 [CANVAS3D DOUBLECLICK] Dialog opening with index: 0
Canvas3D.tsx:1428 🏠 [AIRENTRY DIRECT] Updating position directly for vent - similar to furniture
Canvas3D.tsx:1432 ✅ [AIRENTRY DIRECT] Position updated directly - Material: MeshPhongMaterial, HasTexture: false
Canvas3D.tsx:1428 🏠 [AIRENTRY DIRECT] Updating position directly for vent - similar to furniture
Canvas3D.tsx:1432 ✅ [AIRENTRY DIRECT] Position updated directly - Material: MeshPhongMaterial, HasTexture: false
AirEntryDialog.tsx:499 🎯 [SAVE BUTTON CLICKED] AirEntryDialog handleSubmit triggered
AirEntryDialog.tsx:500 🎯 [SAVE BUTTON CLICKED] Event type: submit
AirEntryDialog.tsx:501 🎯 [SAVE BUTTON CLICKED] Props type: vent
AirEntryDialog.tsx:502 🎯 [SAVE BUTTON CLICKED] Current values: {width: 60, height: 40, distanceToFloor: 110, shape: 'rectangular', wallPosition: 10, …}
AirEntryDialog.tsx:503 🎯 [SAVE BUTTON CLICKED] wallPosition from values: 10
AirEntryDialog.tsx:504 🎯 [SAVE BUTTON CLICKED] wallPosition from state: 10
AirEntryDialog.tsx:599 🎯 [PROPS.ONCONFIRM] About to call props.onConfirm with canvasData
AirEntryDialog.tsx:600 🎯 [PROPS.ONCONFIRM] canvasData being sent: {width: 60, height: 40, distanceToFloor: 110, shape: 'rectangular', wallPosition: 10, …}
AirEntryDialog.tsx:601 🎯 [PROPS.ONCONFIRM] canvasData.wallPosition: 10
AirEntryDialog.tsx:602 🎯 [PROPS.ONCONFIRM] canvasData.position: {x: 630.0124678479477, y: 81.21021147921564}
AirEntryDialog.tsx:603 🎯 [PROPS.ONCONFIRM] This should trigger handleAirEntryEdit in Canvas2D
Canvas3D.tsx:6091 [CANVAS3D ONCONFIRM] Received data from dialog: {width: 60, height: 40, distanceToFloor: 110, shape: 'rectangular', wallPosition: 10, …}
Canvas3D.tsx:6092 [CANVAS3D ONCONFIRM] wallPosition in received data: 10
Canvas3D.tsx:6093 🔍 [SAVE CHANGES DEBUG] About to call handleAirEntryEdit
Canvas3D.tsx:1880 🔍 [CANVAS3D handleAirEntryEdit] Called with index: 0
Canvas3D.tsx:1881 🔍 [CANVAS3D handleAirEntryEdit] Received data: {width: 60, height: 40, distanceToFloor: 110, shape: 'rectangular', wallPosition: 10, …}
Canvas3D.tsx:1882 🔍 [CANVAS3D handleAirEntryEdit] data.wallPosition: 10
Canvas3D.tsx:1921 🚀 Canvas3D: Llamando onUpdateAirEntry - piso: ground, índice: 0
Canvas3D.tsx:1922 🚀 Canvas3D: Datos del AirEntry actualizado: {type: 'vent', position: {…}, line: {…}, dimensions: {…}, properties: {…}}
wizard-design.tsx:1113 🎯 WIZARD: handleUpdateAirEntryFrom3D llamado - piso: ground, índice: 0
wizard-design.tsx:1114 🎯 WIZARD: Datos recibidos del AirEntry: {type: 'vent', position: {…}, line: {…}, dimensions: {…}, properties: {…}}
wizard-design.tsx:1131 📝 WIZARD: Entry clonado con wallPosition preservado: {type: 'vent', position: {…}, line: {…}, dimensions: {…}, properties: {…}}
wizard-design.tsx:1135 ✅ WIZARD: Actualizando piso actual - procediendo con la actualización del store
wizard-design.tsx:1144 📋 WIZARD: setAirEntries ejecutado con nuevo array
wizard-design.tsx:1155 📋 WIZARD: useRoomStore.setFloors ejecutado
wizard-design.tsx:1159 🚨 WIZARD: CRÍTICO - No se está llamando updateAirEntry del store para la sincronización
wizard-design.tsx:1160 🚨 WIZARD: Esto explica por qué no se notifica a otros componentes
wizard-design.tsx:1163 🔧 WIZARD: Llamando updateAirEntry para disparar sincronización
room-store.ts:425 🔄 STORE: updateAirEntry llamado - piso: ground, índice: 0
room-store.ts:426 🔄 STORE: Nueva posición del AirEntry: (630.0124678479477, 81.21021147921564)
room-store.ts:440 ✅ STORE: AirEntry actualizado en el store, notificando a 1 listeners
room-store.ts:444 📢 STORE: Notificando listener 1/1
Canvas3D.tsx:1256 📥 Canvas3D: Recibida notificación de cambio AirEntry - piso: ground, índice: 0
Canvas3D.tsx:1257 📥 Canvas3D: Tipo: vent, posición: (630.0124678479477, 81.21021147921564)
Canvas3D.tsx:1265 ✅ Canvas3D: Aplicando cambio - buscando objetos en escena 3D
Canvas3D.tsx:1278 🎯 Canvas3D: Encontrado objeto vent para actualizar - índice: 0
Canvas3D.tsx:1285 🎯 Canvas3D: Objeto actualizado - nueva posición 3D: (287.5155848099347, 273.48723565098044, 110)
Canvas3D.tsx:1289 📊 Canvas3D: Objetos encontrados: 1, actualizados: 1
Canvas3D.tsx:1293 🔄 Canvas3D: Forzando re-render de la escena
Canvas3D.tsx:1256 📥 Canvas3D: Recibida notificación de cambio AirEntry - piso: ground, índice: 0
Canvas3D.tsx:1257 📥 Canvas3D: Tipo: vent, posición: (630.0124678479477, 81.21021147921564)
Canvas3D.tsx:1265 ✅ Canvas3D: Aplicando cambio - buscando objetos en escena 3D
Canvas3D.tsx:1278 🎯 Canvas3D: Encontrado objeto vent para actualizar - índice: 0
Canvas3D.tsx:1285 🎯 Canvas3D: Objeto actualizado - nueva posición 3D: (287.5155848099347, 273.48723565098044, 110)
Canvas3D.tsx:1289 📊 Canvas3D: Objetos encontrados: 1, actualizados: 1
Canvas3D.tsx:1293 🔄 Canvas3D: Forzando re-render de la escena
wizard-design.tsx:1165 ✅ WIZARD: updateAirEntry completado - debería notificar a Canvas2D, Canvas3D y RSP
Canvas3D.tsx:1926 ✅ Canvas3D: onUpdateAirEntry completado - debería haber actualizado el store
Canvas3D.tsx:1927 📋 Canvas3D: Verificando si esto dispara notificaciones a otros componentes...
Canvas3D.tsx:1939 🔍 [BEFORE CLOSE] Mesh 0 material: {hasMap: false, opacity: 0.7, type: 'vent'}
Canvas3D.tsx:1947 🔬 [DEPENDENCY TRACKING] BEFORE setEditingAirEntry(null):
Canvas3D.tsx:1948 🔬 [DEPENDENCY TRACKING] floors keys: ['ground']
Canvas3D.tsx:1949 🔬 [DEPENDENCY TRACKING] currentFloor: ground
Canvas3D.tsx:1950 🔬 [DEPENDENCY TRACKING] ceilingHeight: 220
Canvas3D.tsx:1951 🔬 [DEPENDENCY TRACKING] floorDeckThickness: 35
Canvas3D.tsx:1952 🔬 [DEPENDENCY TRACKING] floors[currentFloor] airEntries length: 1
Canvas3D.tsx:1953 🔬 [DEPENDENCY TRACKING] selectedAirEntry state: NULL
Canvas3D.tsx:1957 🔬 [DEPENDENCY TRACKING] AFTER setEditingAirEntry(null):
Canvas3D.tsx:1958 🔬 [DEPENDENCY TRACKING] floors keys: ['ground']
Canvas3D.tsx:1959 🔬 [DEPENDENCY TRACKING] currentFloor: ground
Canvas3D.tsx:1960 🔬 [DEPENDENCY TRACKING] ceilingHeight: 220
Canvas3D.tsx:1961 🔬 [DEPENDENCY TRACKING] floorDeckThickness: 35
Canvas3D.tsx:1962 🔬 [DEPENDENCY TRACKING] floors[currentFloor] airEntries length: 1
Canvas3D.tsx:1963 🔬 [DEPENDENCY TRACKING] selectedAirEntry state: NULL
Canvas3D.tsx:1986 ✅ [SAVE CHANGES] Data commit complete - monitoring for texture loss
Canvas3D.tsx:1987 ✅ [SAVE CHANGES] Dialog closed - checking for side effects
Canvas3D.tsx:6102 🔍 [SAVE CHANGES DEBUG] handleAirEntryEdit completed - checking for side effects
AirEntryDialog.tsx:607 🎯 [PROPS.ONCONFIRM] props.onConfirm completed
AirEntryDialog.tsx:608 🎯 [PROPS.ONCONFIRM] Now calling onClose() to close dialog
Canvas3D.tsx:1440 🔍 [HYPOTHESIS TEST] About to call onUpdateAirEntry - this may trigger floors modification
Canvas3D.tsx:1441 🔍 [HYPOTHESIS TEST] Current floors object reference: object
wizard-design.tsx:1113 🎯 WIZARD: handleUpdateAirEntryFrom3D llamado - piso: ground, índice: 0
wizard-design.tsx:1114 🎯 WIZARD: Datos recibidos del AirEntry: {type: 'vent', position: {…}, line: {…}, dimensions: {…}}
wizard-design.tsx:1131 📝 WIZARD: Entry clonado con wallPosition preservado: {type: 'vent', position: {…}, line: {…}, dimensions: {…}}
wizard-design.tsx:1135 ✅ WIZARD: Actualizando piso actual - procediendo con la actualización del store
wizard-design.tsx:1144 📋 WIZARD: setAirEntries ejecutado con nuevo array
wizard-design.tsx:1155 📋 WIZARD: useRoomStore.setFloors ejecutado
wizard-design.tsx:1159 🚨 WIZARD: CRÍTICO - No se está llamando updateAirEntry del store para la sincronización
wizard-design.tsx:1160 🚨 WIZARD: Esto explica por qué no se notifica a otros componentes
wizard-design.tsx:1163 🔧 WIZARD: Llamando updateAirEntry para disparar sincronización
room-store.ts:425 🔄 STORE: updateAirEntry llamado - piso: ground, índice: 0
room-store.ts:426 🔄 STORE: Nueva posición del AirEntry: (630.0124678479477, 81.21021147921564)
room-store.ts:440 ✅ STORE: AirEntry actualizado en el store, notificando a 1 listeners
room-store.ts:444 📢 STORE: Notificando listener 1/1
Canvas3D.tsx:1256 📥 Canvas3D: Recibida notificación de cambio AirEntry - piso: ground, índice: 0
Canvas3D.tsx:1257 📥 Canvas3D: Tipo: vent, posición: (630.0124678479477, 81.21021147921564)
Canvas3D.tsx:1265 ✅ Canvas3D: Aplicando cambio - buscando objetos en escena 3D
Canvas3D.tsx:1278 🎯 Canvas3D: Encontrado objeto vent para actualizar - índice: 0
Canvas3D.tsx:1285 🎯 Canvas3D: Objeto actualizado - nueva posición 3D: (287.5155848099347, 273.48723565098044, 110)
Canvas3D.tsx:1289 📊 Canvas3D: Objetos encontrados: 1, actualizados: 1
Canvas3D.tsx:1293 🔄 Canvas3D: Forzando re-render de la escena
Canvas3D.tsx:1256 📥 Canvas3D: Recibida notificación de cambio AirEntry - piso: ground, índice: 0
Canvas3D.tsx:1257 📥 Canvas3D: Tipo: vent, posición: (630.0124678479477, 81.21021147921564)
Canvas3D.tsx:1265 ✅ Canvas3D: Aplicando cambio - buscando objetos en escena 3D
Canvas3D.tsx:1278 🎯 Canvas3D: Encontrado objeto vent para actualizar - índice: 0
Canvas3D.tsx:1285 🎯 Canvas3D: Objeto actualizado - nueva posición 3D: (287.5155848099347, 273.48723565098044, 110)
Canvas3D.tsx:1289 📊 Canvas3D: Objetos encontrados: 1, actualizados: 1
Canvas3D.tsx:1293 🔄 Canvas3D: Forzando re-render de la escena
wizard-design.tsx:1165 ✅ WIZARD: updateAirEntry completado - debería notificar a Canvas2D, Canvas3D y RSP
Canvas3D.tsx:1443 🔍 [HYPOTHESIS TEST] onUpdateAirEntry completed - floors may have been modified
Canvas3D.tsx:1447 ✅ [OPTIMIZATION] Position update complete - textures preserved automatically
Canvas3D.tsx:1967 🔍 [AFTER CLOSE] Checking textures immediately after dialog close
Canvas3D.tsx:1977 🔍 [AFTER CLOSE] Mesh 0 material: {hasMap: false, opacity: 0.7, type: 'vent'}
Canvas3D.tsx:6106 🔍 [SAVE CHANGES DEBUG] 100ms after Save Changes - checking scene state
Canvas3D.tsx:6114 🔍 [SAVE CHANGES DEBUG] AirEntry meshes found: 1
Canvas3D.tsx:6117 🔍 [SAVE CHANGES DEBUG] Mesh 0 material: {hasMap: false, opacity: 0.7, type: 'vent'}
analytics.ts:62 📊 Analytics Event: {category: 'ui_interaction', action: 'change_tab', label: 'view_2d_editor', value: undefined, status: 'sent'}
wizard-design.tsx:2561 📊 WIZARD: Pasando airEntries a Canvas2D
wizard-design.tsx:2562 📊 WIZARD: rawFloors[ground] existe: true
wizard-design.tsx:2563 📊 WIZARD: rawFloors[ground]?.airEntries length: 1
wizard-design.tsx:2564 📊 WIZARD: fallback airEntries length: 1
wizard-design.tsx:2565 📊 WIZARD: Usando rawAirEntries: SÍ (rawFloors)
wizard-design.tsx:2568 📊 WIZARD: Primer airEntry enviado a Canvas2D - posición: (630.0124678479477, 81.21021147921564)
Canvas3D.tsx:1300 🔗 Canvas3D: Desregistrando suscripción para piso 'ground'
room-store.ts:477 🔗 STORE: Suscripción eliminada. Total listeners: 0
Canvas2D.tsx:408 🔗 Canvas2D: Registrando suscripción para piso 'ground'
Canvas2D.tsx:409 🔗 Canvas2D: subscribeToAirEntryChanges función disponible: true
room-store.ts:469 🔗 STORE: Nueva suscripción añadida. Total listeners: 1
Canvas2D.tsx:436 🔗 Canvas2D: Suscripción creada exitosamente: true
wizard-design.tsx:2561 📊 WIZARD: Pasando airEntries a Canvas2D
wizard-design.tsx:2562 📊 WIZARD: rawFloors[ground] existe: true
wizard-design.tsx:2563 📊 WIZARD: rawFloors[ground]?.airEntries length: 1
wizard-design.tsx:2564 📊 WIZARD: fallback airEntries length: 1
wizard-design.tsx:2565 📊 WIZARD: Usando rawAirEntries: SÍ (rawFloors)
wizard-design.tsx:2568 📊 WIZARD: Primer airEntry enviado a Canvas2D - posición: (630.0124678479477, 81.21021147921564)
wizard-design:1 [.WebGL-0x2c6411656a00] GL_INVALID_OPERATION: Texture is immutable.
wizard-design:1 [.WebGL-0x2c6411656a00] GL_INVALID_OPERATION: Texture is immutable.
wizard-design:1 [.WebGL-0x2c6411656a00] GL_INVALID_OPERATION: Texture is immutable.
wizard-design:1 [.WebGL-0x2c6411656a00] GL_INVALID_OPERATION: Texture is immutable.
wizard-design.tsx:2561 📊 WIZARD: Pasando airEntries a Canvas2D
wizard-design.tsx:2562 📊 WIZARD: rawFloors[ground] existe: true
wizard-design.tsx:2563 📊 WIZARD: rawFloors[ground]?.airEntries length: 1
wizard-design.tsx:2564 📊 WIZARD: fallback airEntries length: 1
wizard-design.tsx:2565 📊 WIZARD: Usando rawAirEntries: SÍ (rawFloors)
wizard-design.tsx:2568 📊 WIZARD: Primer airEntry enviado a Canvas2D - posición: (630.0124678479477, 81.21021147921564)
wizard-design.tsx:2561 📊 WIZARD: Pasando airEntries a Canvas2D
wizard-design.tsx:2562 📊 WIZARD: rawFloors[ground] existe: true
wizard-design.tsx:2563 📊 WIZARD: rawFloors[ground]?.airEntries length: 1
wizard-design.tsx:2564 📊 WIZARD: fallback airEntries length: 1
wizard-design.tsx:2565 📊 WIZARD: Usando rawAirEntries: SÍ (rawFloors)
wizard-design.tsx:2568 📊 WIZARD: Primer airEntry enviado a Canvas2D - posición: (630.0124678479477, 81.21021147921564)
wizard-design.tsx:2561 📊 WIZARD: Pasando airEntries a Canvas2D
wizard-design.tsx:2562 📊 WIZARD: rawFloors[ground] existe: true
wizard-design.tsx:2563 📊 WIZARD: rawFloors[ground]?.airEntries length: 1
wizard-design.tsx:2564 📊 WIZARD: fallback airEntries length: 1
wizard-design.tsx:2565 📊 WIZARD: Usando rawAirEntries: SÍ (rawFloors)
wizard-design.tsx:2568 📊 WIZARD: Primer airEntry enviado a Canvas2D - posición: (684.5155848099347, 42.01276434901955)
AirEntryDialog.tsx:499 🎯 [SAVE BUTTON CLICKED] AirEntryDialog handleSubmit triggered
AirEntryDialog.tsx:500 🎯 [SAVE BUTTON CLICKED] Event type: submit
AirEntryDialog.tsx:501 🎯 [SAVE BUTTON CLICKED] Props type: vent
AirEntryDialog.tsx:502 🎯 [SAVE BUTTON CLICKED] Current values: {width: 60, height: 40, distanceToFloor: 110, shape: 'rectangular', wallPosition: 0, …}
AirEntryDialog.tsx:503 🎯 [SAVE BUTTON CLICKED] wallPosition from values: 0
AirEntryDialog.tsx:504 🎯 [SAVE BUTTON CLICKED] wallPosition from state: 0
AirEntryDialog.tsx:599 🎯 [PROPS.ONCONFIRM] About to call props.onConfirm with canvasData
AirEntryDialog.tsx:600 🎯 [PROPS.ONCONFIRM] canvasData being sent: {width: 60, height: 40, distanceToFloor: 110, shape: 'rectangular', wallPosition: 0, …}
AirEntryDialog.tsx:601 🎯 [PROPS.ONCONFIRM] canvasData.wallPosition: 0
AirEntryDialog.tsx:602 🎯 [PROPS.ONCONFIRM] canvasData.position: {x: 684.5155848099347, y: 42.01276434901955}
AirEntryDialog.tsx:603 🎯 [PROPS.ONCONFIRM] This should trigger handleAirEntryEdit in Canvas2D
AirEntryDialog.tsx:607 🎯 [PROPS.ONCONFIRM] props.onConfirm completed
AirEntryDialog.tsx:608 🎯 [PROPS.ONCONFIRM] Now calling onClose() to close dialog
wizard-design.tsx:2561 📊 WIZARD: Pasando airEntries a Canvas2D
wizard-design.tsx:2562 📊 WIZARD: rawFloors[ground] existe: true
wizard-design.tsx:2563 📊 WIZARD: rawFloors[ground]?.airEntries length: 1
wizard-design.tsx:2564 📊 WIZARD: fallback airEntries length: 1
wizard-design.tsx:2565 📊 WIZARD: Usando rawAirEntries: SÍ (rawFloors)
wizard-design.tsx:2568 📊 WIZARD: Primer airEntry enviado a Canvas2D - posición: (684.5155848099347, 42.01276434901955)
analytics.ts:62 📊 Analytics Event: {category: 'ui_interaction', action: 'change_tab', label: 'view_3d_preview', value: undefined, status: 'sent'}
Canvas2D.tsx:439 🔗 Canvas2D: Desregistrando suscripción para piso 'ground'
room-store.ts:477 🔗 STORE: Suscripción eliminada. Total listeners: 0
Canvas3D.tsx:1253 🔗 Canvas3D: Registrando suscripción para sincronización de AirEntry en piso 'ground'
room-store.ts:469 🔗 STORE: Nueva suscripción añadida. Total listeners: 1
Canvas3D.tsx:4843 🚨 [SCENE REBUILD TRIGGER] useEffect triggered - dependencies changed
Canvas3D.tsx:4844 🚨 [SCENE REBUILD TRIGGER] floors reference: {ground: {…}}
Canvas3D.tsx:4845 🚨 [SCENE REBUILD TRIGGER] floors identity hash: {"ground":{"lines":[{"id":"1751137688710_hex1ykx9c...
Canvas3D.tsx:4846 🚨 [SCENE REBUILD TRIGGER] currentFloor: ground
Canvas3D.tsx:4847 🚨 [SCENE REBUILD TRIGGER] ceilingHeight: 220
Canvas3D.tsx:4848 🚨 [SCENE REBUILD TRIGGER] floorDeckThickness: 35
Canvas3D.tsx:2406 🔧 [SCENE REBUILD] Creating new material for vent at index 0
Canvas3D.tsx:5381 🔧 [WALL TRANSPARENCY] Updating wall transparency, preserving AirEntry textures
Canvas3D.tsx:5395 🔧 [WALL TRANSPARENCY] Updating wall material opacity to: 0.2
Canvas3D.tsx:5395 🔧 [WALL TRANSPARENCY] Updating wall material opacity to: 0.2
Canvas3D.tsx:5395 🔧 [WALL TRANSPARENCY] Updating wall material opacity to: 0.2
Canvas3D.tsx:5395 🔧 [WALL TRANSPARENCY] Updating wall material opacity to: 0.2
Canvas3D.tsx:5395 🔧 [WALL TRANSPARENCY] Updating wall material opacity to: 0.2
Canvas3D.tsx:5400 ✅ [WALL TRANSPARENCY] Preserving AirEntry material - hasTexture: false opacity: 0.7
chunk-WERSD76P.js?v=cfa7cc5f:18625 [Violation] 'click' handler took 267ms
Canvas3D.tsx:4736 Double-click position search: {airEntryData: {…}, entryPosition: {…}, storedEntryIndex: 0}
Canvas3D.tsx:4746 Double-click found entry using stored entryIndex: 0
Canvas3D.tsx:4774 🔍 [CANVAS3D DOUBLECLICK] baseEntry from store: {type: 'vent', position: {…}, line: {…}, dimensions: {…}}
Canvas3D.tsx:4775 🔍 [CANVAS3D DOUBLECLICK] baseEntry.dimensions: {width: 60, height: 40, distanceToFloor: 110, shape: 'rectangular', wallPosition: 0}
Canvas3D.tsx:4776 🔍 [CANVAS3D DOUBLECLICK] baseEntry.dimensions.wallPosition: 0
Canvas3D.tsx:4781 🔍 [CANVAS3D DOUBLECLICK] updatedData from ref: undefined
Canvas3D.tsx:4788 🔍 [CANVAS3D DOUBLECLICK] mergedEntry: {type: 'vent', position: {…}, line: {…}, dimensions: {…}}
Canvas3D.tsx:4789 🔍 [CANVAS3D DOUBLECLICK] mergedEntry.dimensions.wallPosition: 0
Canvas3D.tsx:4800 🔍 [CANVAS3D DOUBLECLICK] Dialog opening with index: 0
Canvas3D.tsx:1428 🏠 [AIRENTRY DIRECT] Updating position directly for vent - similar to furniture
Canvas3D.tsx:1432 ✅ [AIRENTRY DIRECT] Position updated directly - Material: MeshPhongMaterial, HasTexture: false
Canvas3D.tsx:1428 🏠 [AIRENTRY DIRECT] Updating position directly for vent - similar to furniture
Canvas3D.tsx:1432 ✅ [AIRENTRY DIRECT] Position updated directly - Material: MeshPhongMaterial, HasTexture: false
Canvas3D.tsx:1440 🔍 [HYPOTHESIS TEST] About to call onUpdateAirEntry - this may trigger floors modification
Canvas3D.tsx:1441 🔍 [HYPOTHESIS TEST] Current floors object reference: object
wizard-design.tsx:1113 🎯 WIZARD: handleUpdateAirEntryFrom3D llamado - piso: ground, índice: 0
wizard-design.tsx:1114 🎯 WIZARD: Datos recibidos del AirEntry: {type: 'vent', position: {…}, line: {…}, dimensions: {…}}
wizard-design.tsx:1131 📝 WIZARD: Entry clonado con wallPosition preservado: {type: 'vent', position: {…}, line: {…}, dimensions: {…}}
wizard-design.tsx:1135 ✅ WIZARD: Actualizando piso actual - procediendo con la actualización del store
wizard-design.tsx:1144 📋 WIZARD: setAirEntries ejecutado con nuevo array
wizard-design.tsx:1155 📋 WIZARD: useRoomStore.setFloors ejecutado
wizard-design.tsx:1159 🚨 WIZARD: CRÍTICO - No se está llamando updateAirEntry del store para la sincronización
wizard-design.tsx:1160 🚨 WIZARD: Esto explica por qué no se notifica a otros componentes
wizard-design.tsx:1163 🔧 WIZARD: Llamando updateAirEntry para disparar sincronización
room-store.ts:425 🔄 STORE: updateAirEntry llamado - piso: ground, índice: 0
room-store.ts:426 🔄 STORE: Nueva posición del AirEntry: (412, 238)
room-store.ts:440 ✅ STORE: AirEntry actualizado en el store, notificando a 1 listeners
room-store.ts:444 📢 STORE: Notificando listener 1/1
Canvas3D.tsx:1256 📥 Canvas3D: Recibida notificación de cambio AirEntry - piso: ground, índice: 0
Canvas3D.tsx:1257 📥 Canvas3D: Tipo: vent, posición: (412, 238)
Canvas3D.tsx:1265 ✅ Canvas3D: Aplicando cambio - buscando objetos en escena 3D
Canvas3D.tsx:1278 🎯 Canvas3D: Encontrado objeto vent para actualizar - índice: 0
Canvas3D.tsx:1285 🎯 Canvas3D: Objeto actualizado - nueva posición 3D: (15, 77.5, 110)
Canvas3D.tsx:1289 📊 Canvas3D: Objetos encontrados: 1, actualizados: 1
Canvas3D.tsx:1293 🔄 Canvas3D: Forzando re-render de la escena
Canvas3D.tsx:1256 📥 Canvas3D: Recibida notificación de cambio AirEntry - piso: ground, índice: 0
Canvas3D.tsx:1257 📥 Canvas3D: Tipo: vent, posición: (412, 238)
 ✅ Canvas3D: Aplicando cambio - buscando objetos en escena 3D
 🎯 Canvas3D: Encontrado objeto vent para actualizar - índice: 0
 🎯 Canvas3D: Objeto actualizado - nueva posición 3D: (15, 77.5, 110)
 📊 Canvas3D: Objetos encontrados: 1, actualizados: 1
 🔄 Canvas3D: Forzando re-render de la escena
 ✅ WIZARD: updateAirEntry completado - debería notificar a Canvas2D, Canvas3D y RSP
 🔍 [HYPOTHESIS TEST] onUpdateAirEntry completed - floors may have been modified
 ✅ [OPTIMIZATION] Position update complete - textures preserved automatically
 🎯 [SAVE BUTTON CLICKED] AirEntryDialog handleSubmit triggered
 🎯 [SAVE BUTTON CLICKED] Event type: submit
 🎯 [SAVE BUTTON CLICKED] Props type: vent
 🎯 [SAVE BUTTON CLICKED] Current values: {width: 60, height: 40, distanceToFloor: 110, shape: 'rectangular', wallPosition: 50, …}
 🎯 [SAVE BUTTON CLICKED] wallPosition from values: 50
 🎯 [SAVE BUTTON CLICKED] wallPosition from state: 50
 🎯 [PROPS.ONCONFIRM] About to call props.onConfirm with canvasData
 🎯 [PROPS.ONCONFIRM] canvasData being sent: {width: 60, height: 40, distanceToFloor: 110, shape: 'rectangular', wallPosition: 50, …}
 🎯 [PROPS.ONCONFIRM] canvasData.wallPosition: 50
 🎯 [PROPS.ONCONFIRM] canvasData.position: {x: 412, y: 238}
 🎯 [PROPS.ONCONFIRM] This should trigger handleAirEntryEdit in Canvas2D
 [CANVAS3D ONCONFIRM] Received data from dialog: {width: 60, height: 40, distanceToFloor: 110, shape: 'rectangular', wallPosition: 50, …}
 [CANVAS3D ONCONFIRM] wallPosition in received data: 50
 🔍 [SAVE CHANGES DEBUG] About to call handleAirEntryEdit
 🔍 [CANVAS3D handleAirEntryEdit] Called with index: 0
 🔍 [CANVAS3D handleAirEntryEdit] Received data: {width: 60, height: 40, distanceToFloor: 110, shape: 'rectangular', wallPosition: 50, …}
 🔍 [CANVAS3D handleAirEntryEdit] data.wallPosition: 50
 🚀 Canvas3D: Llamando onUpdateAirEntry - piso: ground, índice: 0
 🚀 Canvas3D: Datos del AirEntry actualizado: {type: 'vent', position: {…}, line: {…}, dimensions: {…}, properties: {…}}
 🎯 WIZARD: handleUpdateAirEntryFrom3D llamado - piso: ground, índice: 0
 🎯 WIZARD: Datos recibidos del AirEntry: {type: 'vent', position: {…}, line: {…}, dimensions: {…}, properties: {…}}
 📝 WIZARD: Entry clonado con wallPosition preservado: {type: 'vent', position: {…}, line: {…}, dimensions: {…}, properties: {…}}
 ✅ WIZARD: Actualizando piso actual - procediendo con la actualización del store
 📋 WIZARD: setAirEntries ejecutado con nuevo array
 📋 WIZARD: useRoomStore.setFloors ejecutado
 🚨 WIZARD: CRÍTICO - No se está llamando updateAirEntry del store para la sincronización
 🚨 WIZARD: Esto explica por qué no se notifica a otros componentes
 🔧 WIZARD: Llamando updateAirEntry para disparar sincronización
 🔄 STORE: updateAirEntry llamado - piso: ground, índice: 0
 🔄 STORE: Nueva posición del AirEntry: (412, 238)
 ✅ STORE: AirEntry actualizado en el store, notificando a 1 listeners
 📢 STORE: Notificando listener 1/1
 📥 Canvas3D: Recibida notificación de cambio AirEntry - piso: ground, índice: 0
 📥 Canvas3D: Tipo: vent, posición: (412, 238)
 ✅ Canvas3D: Aplicando cambio - buscando objetos en escena 3D
 🎯 Canvas3D: Encontrado objeto vent para actualizar - índice: 0
 🎯 Canvas3D: Objeto actualizado - nueva posición 3D: (15, 77.5, 110)
 📊 Canvas3D: Objetos encontrados: 1, actualizados: 1
 🔄 Canvas3D: Forzando re-render de la escena
 📥 Canvas3D: Recibida notificación de cambio AirEntry - piso: ground, índice: 0
 📥 Canvas3D: Tipo: vent, posición: (412, 238)
 ✅ Canvas3D: Aplicando cambio - buscando objetos en escena 3D
 🎯 Canvas3D: Encontrado objeto vent para actualizar - índice: 0
 🎯 Canvas3D: Objeto actualizado - nueva posición 3D: (15, 77.5, 110)
 📊 Canvas3D: Objetos encontrados: 1, actualizados: 1
 🔄 Canvas3D: Forzando re-render de la escena
 ✅ WIZARD: updateAirEntry completado - debería notificar a Canvas2D, Canvas3D y RSP
 ✅ Canvas3D: onUpdateAirEntry completado - debería haber actualizado el store
 📋 Canvas3D: Verificando si esto dispara notificaciones a otros componentes...
 🔍 [BEFORE CLOSE] Mesh 0 material: {hasMap: false, opacity: 0.7, type: 'vent'}
 🔬 [DEPENDENCY TRACKING] BEFORE setEditingAirEntry(null):
 🔬 [DEPENDENCY TRACKING] floors keys: ['ground']
 🔬 [DEPENDENCY TRACKING] currentFloor: ground
 🔬 [DEPENDENCY TRACKING] ceilingHeight: 220
 🔬 [DEPENDENCY TRACKING] floorDeckThickness: 35
 🔬 [DEPENDENCY TRACKING] floors[currentFloor] airEntries length: 1
 🔬 [DEPENDENCY TRACKING] selectedAirEntry state: NULL
 🔬 [DEPENDENCY TRACKING] AFTER setEditingAirEntry(null):
 🔬 [DEPENDENCY TRACKING] floors keys: ['ground']
 🔬 [DEPENDENCY TRACKING] currentFloor: ground
 🔬 [DEPENDENCY TRACKING] ceilingHeight: 220
 🔬 [DEPENDENCY TRACKING] floorDeckThickness: 35
 🔬 [DEPENDENCY TRACKING] floors[currentFloor] airEntries length: 1
 🔬 [DEPENDENCY TRACKING] selectedAirEntry state: NULL
 ✅ [SAVE CHANGES] Data commit complete - monitoring for texture loss
 ✅ [SAVE CHANGES] Dialog closed - checking for side effects
 🔍 [SAVE CHANGES DEBUG] handleAirEntryEdit completed - checking for side effects
 🎯 [PROPS.ONCONFIRM] props.onConfirm completed
 🎯 [PROPS.ONCONFIRM] Now calling onClose() to close dialog
 🔍 [AFTER CLOSE] Checking textures immediately after dialog close
 🔍 [AFTER CLOSE] Mesh 0 material: {hasMap: false, opacity: 0.7, type: 'vent'}
 🔍 [SAVE CHANGES DEBUG] 100ms after Save Changes - checking scene state
 🔍 [SAVE CHANGES DEBUG] AirEntry meshes found: 1
 🔍 [SAVE CHANGES DEBUG] Mesh 0 material: {hasMap: false, opacity: 0.7, type: 'vent'}
 🔗 Canvas3D: Desregistrando suscripción para piso 'ground'
 🔗 STORE: Suscripción eliminada. Total listeners: 0
 🔗 Canvas3D: Registrando suscripción para sincronización de AirEntry en piso 'ground'
 🔗 STORE: Nueva suscripción añadida. Total listeners: 1
 🚨 [SCENE REBUILD TRIGGER] useEffect triggered - dependencies changed
 🚨 [SCENE REBUILD TRIGGER] floors reference: {ground: {…}}
 🚨 [SCENE REBUILD TRIGGER] floors identity hash: {"ground":{"lines":[{"id":"1751137688710_hex1ykx9c...
 🚨 [SCENE REBUILD TRIGGER] currentFloor: ground
 🚨 [SCENE REBUILD TRIGGER] ceilingHeight: 220
 🚨 [SCENE REBUILD TRIGGER] floorDeckThickness: 35
 🔧 [SCENE REBUILD] Creating new material for vent at index 0
 🔧 [WALL TRANSPARENCY] Updating wall transparency, preserving AirEntry textures
 🔧 [WALL TRANSPARENCY] Updating wall material opacity to: 0.2
 🔧 [WALL TRANSPARENCY] Updating wall material opacity to: 0.2
 🔧 [WALL TRANSPARENCY] Updating wall material opacity to: 0.2
 🔧 [WALL TRANSPARENCY] Updating wall material opacity to: 0.2
 🔧 [WALL TRANSPARENCY] Updating wall material opacity to: 0.2
 ✅ [WALL TRANSPARENCY] Preserving AirEntry material - hasTexture: false opacity: 0.7
 ✅ [TRANSPARENCY UPDATE] Preserving existing material properties, only updating opacity
 ✅ [TRANSPARENCY UPDATE] Material has texture: true
 🔗 RSP: Registrando suscripción para sincronización de AirEntry
 🔗 STORE: Nueva suscripción añadida. Total listeners: 2
chunk-WERSD76P.js:18625 [Violation] 'click' handler took 313ms
wizard-design:1 [.WebGL-0x2c64126fbf00] GL_INVALID_OPERATION: Texture is immutable.
wizard-design:1 [.WebGL-0x2c64126fbf00] GL_INVALID_OPERATION: Texture is immutable.
wizard-design:1 [.WebGL-0x2c64126fbf00] GL_INVALID_OPERATION: Texture is immutable.
wizard-design:1 [.WebGL-0x2c64126fbf00] GL_INVALID_OPERATION: Texture is immutable.
 Double-click position search: {airEntryData: {…}, entryPosition: {…}, storedEntryIndex: 0}
 Double-click found entry using stored entryIndex: 0
 🔍 [CANVAS3D DOUBLECLICK] baseEntry from store: {type: 'vent', position: {…}, line: {…}, dimensions: {…}}
 🔍 [CANVAS3D DOUBLECLICK] baseEntry.dimensions: {width: 60, height: 40, distanceToFloor: 110, shape: 'rectangular', wallPosition: 0}
 🔍 [CANVAS3D DOUBLECLICK] baseEntry.dimensions.wallPosition: 0
 🔍 [CANVAS3D DOUBLECLICK] updatedData from ref: undefined
 🔍 [CANVAS3D DOUBLECLICK] mergedEntry: {type: 'vent', position: {…}, line: {…}, dimensions: {…}}
 🔍 [CANVAS3D DOUBLECLICK] mergedEntry.dimensions.wallPosition: 0
 🔍 [CANVAS3D DOUBLECLICK] Dialog opening with index: 0
 🎯 [SAVE BUTTON CLICKED] AirEntryDialog handleSubmit triggered
 🎯 [SAVE BUTTON CLICKED] Event type: submit
 🎯 [SAVE BUTTON CLICKED] Props type: vent
 🎯 [SAVE BUTTON CLICKED] Current values: {width: 60, height: 40, distanceToFloor: 110, shape: 'rectangular', wallPosition: undefined, …}
 🎯 [SAVE BUTTON CLICKED] wallPosition from values: undefined
 🎯 [SAVE BUTTON CLICKED] wallPosition from state: 0
 🎯 [PROPS.ONCONFIRM] About to call props.onConfirm with canvasData
 🎯 [PROPS.ONCONFIRM] canvasData being sent: {width: 60, height: 40, distanceToFloor: 110, shape: 'rectangular', wallPosition: 0, …}
 🎯 [PROPS.ONCONFIRM] canvasData.wallPosition: 0
 🎯 [PROPS.ONCONFIRM] canvasData.position: {x: 684.52, y: 42.01}
 🎯 [PROPS.ONCONFIRM] This should trigger handleAirEntryEdit in Canvas2D
 [CANVAS3D ONCONFIRM] Received data from dialog: {width: 60, height: 40, distanceToFloor: 110, shape: 'rectangular', wallPosition: 0, …}
 [CANVAS3D ONCONFIRM] wallPosition in received data: 0
 🔍 [SAVE CHANGES DEBUG] About to call handleAirEntryEdit
 🔍 [CANVAS3D handleAirEntryEdit] Called with index: 0
 🔍 [CANVAS3D handleAirEntryEdit] Received data: {width: 60, height: 40, distanceToFloor: 110, shape: 'rectangular', wallPosition: 0, …}
 🔍 [CANVAS3D handleAirEntryEdit] data.wallPosition: 0
 🚀 Canvas3D: Llamando onUpdateAirEntry - piso: ground, índice: 0
 🚀 Canvas3D: Datos del AirEntry actualizado: {type: 'vent', position: {…}, line: {…}, dimensions: {…}, properties: {…}}
 ✅ Canvas3D: onUpdateAirEntry completado - debería haber actualizado el store
 📋 Canvas3D: Verificando si esto dispara notificaciones a otros componentes...
 🔍 [BEFORE CLOSE] Mesh 0 material: {hasMap: true, opacity: 1, type: 'vent'}
 🔬 [DEPENDENCY TRACKING] BEFORE setEditingAirEntry(null):
 🔬 [DEPENDENCY TRACKING] floors keys: ['ground']
 🔬 [DEPENDENCY TRACKING] currentFloor: ground
 🔬 [DEPENDENCY TRACKING] ceilingHeight: 220
 🔬 [DEPENDENCY TRACKING] floorDeckThickness: 35
 🔬 [DEPENDENCY TRACKING] floors[currentFloor] airEntries length: 1
 🔬 [DEPENDENCY TRACKING] selectedAirEntry state: NULL
 🔬 [DEPENDENCY TRACKING] AFTER setEditingAirEntry(null):
 🔬 [DEPENDENCY TRACKING] floors keys: ['ground']
 🔬 [DEPENDENCY TRACKING] currentFloor: ground
 🔬 [DEPENDENCY TRACKING] ceilingHeight: 220
 🔬 [DEPENDENCY TRACKING] floorDeckThickness: 35
 🔬 [DEPENDENCY TRACKING] floors[currentFloor] airEntries length: 1
 🔬 [DEPENDENCY TRACKING] selectedAirEntry state: NULL
 ✅ [SAVE CHANGES] Data commit complete - monitoring for texture loss
 ✅ [SAVE CHANGES] Dialog closed - checking for side effects
 🔍 [SAVE CHANGES DEBUG] handleAirEntryEdit completed - checking for side effects
 🎯 [PROPS.ONCONFIRM] props.onConfirm completed
 🎯 [PROPS.ONCONFIRM] Now calling onClose() to close dialog
 🔍 [AFTER CLOSE] Checking textures immediately after dialog close
 🔍 [AFTER CLOSE] Mesh 0 material: {hasMap: true, opacity: 1, type: 'vent'}
 🔍 [SAVE CHANGES DEBUG] 100ms after Save Changes - checking scene state
 🔍 [SAVE CHANGES DEBUG] AirEntry meshes found: 1
 🔍 [SAVE CHANGES DEBUG] Mesh 0 material: {hasMap: true, opacity: 1, type: 'vent'}
 🔗 RSP: Desregistrando suscripción para sincronización de AirEntry
 🔗 STORE: Suscripción eliminada. Total listeners: 1
 🔗 Canvas3D: Desregistrando suscripción para piso 'ground'
 🔗 STORE: Suscripción eliminada. Total listeners: 0
 🔗 Canvas3D: Registrando suscripción para sincronización de AirEntry en piso 'ground'
 🔗 STORE: Nueva suscripción añadida. Total listeners: 1
 🚨 [SCENE REBUILD TRIGGER] useEffect triggered - dependencies changed
 🚨 [SCENE REBUILD TRIGGER] floors reference: {ground: {…}}
 🚨 [SCENE REBUILD TRIGGER] floors identity hash: {"ground":{"lines":[{"id":"1751137688710_hex1ykx9c...
 🚨 [SCENE REBUILD TRIGGER] currentFloor: ground
 🚨 [SCENE REBUILD TRIGGER] ceilingHeight: 220
 🚨 [SCENE REBUILD TRIGGER] floorDeckThickness: 35
 🔧 [SCENE REBUILD] Creating new material for vent at index 0
 🔧 [WALL TRANSPARENCY] Updating wall transparency, preserving AirEntry textures
 🔧 [WALL TRANSPARENCY] Updating wall material opacity to: 0.2
 🔧 [WALL TRANSPARENCY] Updating wall material opacity to: 0.2
 🔧 [WALL TRANSPARENCY] Updating wall material opacity to: 0.2
 🔧 [WALL TRANSPARENCY] Updating wall material opacity to: 0.2
 🔧 [WALL TRANSPARENCY] Updating wall material opacity to: 0.2
 ✅ [WALL TRANSPARENCY] Preserving AirEntry material - hasTexture: false opacity: 0.7
chunk-WERSD76P.js:18625 [Violation] 'click' handler took 250ms
wizard-design:1 [.WebGL-0x2c64117d4600] GL_INVALID_OPERATION: Texture is immutable.
wizard-design:1 [.WebGL-0x2c64117d4600] GL_INVALID_OPERATION: Texture is immutable.
wizard-design:1 [.WebGL-0x2c64117d4600] GL_INVALID_OPERATION: Texture is immutable.
wizard-design:1 [.WebGL-0x2c64117d4600] GL_INVALID_OPERATION: Texture is immutable.
wizard-design:1 [.WebGL-0x2c64117d4600] GL_INVALID_OPERATION: Texture is immutable.
wizard-design:1 [.WebGL-0x2c64117d4600] GL_INVALID_OPERATION: Texture is immutable.
wizard-design:1 [.WebGL-0x2c64117d4600] GL_INVALID_OPERATION: Texture is immutable.
 🔗 Canvas3D: Desregistrando suscripción para piso 'ground'
 🔗 STORE: Suscripción eliminada. Total listeners: 0
 🔗 Canvas3D: Registrando suscripción para sincronización de AirEntry en piso 'ground'
 🔗 STORE: Nueva suscripción añadida. Total listeners: 1
 🚨 [SCENE REBUILD TRIGGER] useEffect triggered - dependencies changed
 🚨 [SCENE REBUILD TRIGGER] floors reference: {ground: {…}}
 🚨 [SCENE REBUILD TRIGGER] floors identity hash: {"ground":{"lines":[{"id":"1751137688710_hex1ykx9c...
 🚨 [SCENE REBUILD TRIGGER] currentFloor: ground
 🚨 [SCENE REBUILD TRIGGER] ceilingHeight: 220
 🚨 [SCENE REBUILD TRIGGER] floorDeckThickness: 35
 🔧 [SCENE REBUILD] Creating new material for vent at index 0
 🔧 [WALL TRANSPARENCY] Updating wall transparency, preserving AirEntry textures
 🔧 [WALL TRANSPARENCY] Updating wall material opacity to: 0.2
 🔧 [WALL TRANSPARENCY] Updating wall material opacity to: 0.2
 🔧 [WALL TRANSPARENCY] Updating wall material opacity to: 0.2
 🔧 [WALL TRANSPARENCY] Updating wall material opacity to: 0.2
 🔧 [WALL TRANSPARENCY] Updating wall material opacity to: 0.2
 ✅ [WALL TRANSPARENCY] Preserving AirEntry material - hasTexture: false opacity: 0.7
 ✅ [TRANSPARENCY UPDATE] Preserving existing material properties, only updating opacity
 ✅ [TRANSPARENCY UPDATE] Material has texture: true
 🔗 RSP: Registrando suscripción para sincronización de AirEntry
 🔗 STORE: Nueva suscripción añadida. Total listeners: 2
chunk-WERSD76P.js:18625 [Violation] 'click' handler took 217ms
wizard-design:1 [.WebGL-0x2c640f3de200] GL_INVALID_OPERATION: Texture is immutable.
wizard-design:1 [.WebGL-0x2c640f3de200] GL_INVALID_OPERATION: Texture is immutable.
wizard-design:1 [.WebGL-0x2c640f3de200] GL_INVALID_OPERATION: Texture is immutable.
wizard-design:1 [.WebGL-0x2c640f3de200] GL_INVALID_OPERATION: Texture is immutable.
 🔗 RSP: Desregistrando suscripción para sincronización de AirEntry
 🔗 STORE: Suscripción eliminada. Total listeners: 1
 🔗 Canvas3D: Desregistrando suscripción para piso 'ground'
 🔗 STORE: Suscripción eliminada. Total listeners: 0
 🔗 Canvas3D: Registrando suscripción para sincronización de AirEntry en piso 'ground'
 🔗 STORE: Nueva suscripción añadida. Total listeners: 1
 🚨 [SCENE REBUILD TRIGGER] useEffect triggered - dependencies changed
 🚨 [SCENE REBUILD TRIGGER] floors reference: {ground: {…}}
 🚨 [SCENE REBUILD TRIGGER] floors identity hash: {"ground":{"lines":[{"id":"1751137688710_hex1ykx9c...
 🚨 [SCENE REBUILD TRIGGER] currentFloor: ground
 🚨 [SCENE REBUILD TRIGGER] ceilingHeight: 220
 🚨 [SCENE REBUILD TRIGGER] floorDeckThickness: 35
 🔧 [SCENE REBUILD] Creating new material for vent at index 0
 🔧 [WALL TRANSPARENCY] Updating wall transparency, preserving AirEntry textures
 🔧 [WALL TRANSPARENCY] Updating wall material opacity to: 0.2
 🔧 [WALL TRANSPARENCY] Updating wall material opacity to: 0.2
 🔧 [WALL TRANSPARENCY] Updating wall material opacity to: 0.2
 🔧 [WALL TRANSPARENCY] Updating wall material opacity to: 0.2
 🔧 [WALL TRANSPARENCY] Updating wall material opacity to: 0.2
 ✅ [WALL TRANSPARENCY] Preserving AirEntry material - hasTexture: false opacity: 0.7
chunk-WERSD76P.js:18625 [Violation] 'click' handler took 243ms
wizard-design:1 [.WebGL-0x2c64126f8700] GL_INVALID_OPERATION: Texture is immutable.
wizard-design:1 [.WebGL-0x2c64126f8700] GL_INVALID_OPERATION: Texture is immutable.
wizard-design:1 [.WebGL-0x2c64126f8700] GL_INVALID_OPERATION: Texture is immutable.
wizard-design:1 [.WebGL-0x2c64126f8700] GL_INVALID_OPERATION: Texture is immutable.
wizard-design:1 [.WebGL-0x2c64126f8700] GL_INVALID_OPERATION: Texture is immutable.
wizard-design:1 [.WebGL-0x2c64126f8700] GL_INVALID_OPERATION: Texture is immutable.
wizard-design:1 [.WebGL-0x2c64126f8700] GL_INVALID_OPERATION: Texture is immutable.
 📊 Analytics Event: {category: 'ui_interaction', action: 'change_tab', label: 'view_2d_editor', value: undefined, status: 'sent'}
 📊 WIZARD: Pasando airEntries a Canvas2D
 📊 WIZARD: rawFloors[ground] existe: true
 📊 WIZARD: rawFloors[ground]?.airEntries length: 1
 📊 WIZARD: fallback airEntries length: 1
 📊 WIZARD: Usando rawAirEntries: SÍ (rawFloors)
 📊 WIZARD: Primer airEntry enviado a Canvas2D - posición: (412, 238)
 🔗 Canvas3D: Desregistrando suscripción para piso 'ground'
 🔗 STORE: Suscripción eliminada. Total listeners: 0
 🔗 Canvas2D: Registrando suscripción para piso 'ground'
 🔗 Canvas2D: subscribeToAirEntryChanges función disponible: true
 🔗 STORE: Nueva suscripción añadida. Total listeners: 1
 🔗 Canvas2D: Suscripción creada exitosamente: true
 📊 WIZARD: Pasando airEntries a Canvas2D
 📊 WIZARD: rawFloors[ground] existe: true
 📊 WIZARD: rawFloors[ground]?.airEntries length: 1
 📊 WIZARD: fallback airEntries length: 1
 📊 WIZARD: Usando rawAirEntries: SÍ (rawFloors)
 📊 WIZARD: Primer airEntry enviado a Canvas2D - posición: (412, 238)
wizard-design:1 [.WebGL-0x2c64126fdb00] GL_INVALID_OPERATION: Texture is immutable.
wizard-design:1 [.WebGL-0x2c64126fdb00] GL_INVALID_OPERATION: Texture is immutable.
wizard-design:1 [.WebGL-0x2c64126fdb00] GL_INVALID_OPERATION: Texture is immutable.
wizard-design:1 [.WebGL-0x2c64126fdb00] GL_INVALID_OPERATION: Texture is immutable.
 📊 Analytics Event: {category: 'ui_interaction', action: 'change_tab', label: 'view_3d_preview', value: undefined, status: 'sent'}
 🔗 Canvas2D: Desregistrando suscripción para piso 'ground'
 🔗 STORE: Suscripción eliminada. Total listeners: 0
 🔗 Canvas3D: Registrando suscripción para sincronización de AirEntry en piso 'ground'
 🔗 STORE: Nueva suscripción añadida. Total listeners: 1
 🚨 [SCENE REBUILD TRIGGER] useEffect triggered - dependencies changed
 🚨 [SCENE REBUILD TRIGGER] floors reference: {ground: {…}}
 🚨 [SCENE REBUILD TRIGGER] floors identity hash: {"ground":{"lines":[{"id":"1751137688710_hex1ykx9c...
 🚨 [SCENE REBUILD TRIGGER] currentFloor: ground
 🚨 [SCENE REBUILD TRIGGER] ceilingHeight: 220
 🚨 [SCENE REBUILD TRIGGER] floorDeckThickness: 35
 🔧 [SCENE REBUILD] Creating new material for vent at index 0
 🔧 [WALL TRANSPARENCY] Updating wall transparency, preserving AirEntry textures
 🔧 [WALL TRANSPARENCY] Updating wall material opacity to: 0.2
 🔧 [WALL TRANSPARENCY] Updating wall material opacity to: 0.2
 🔧 [WALL TRANSPARENCY] Updating wall material opacity to: 0.2
 🔧 [WALL TRANSPARENCY] Updating wall material opacity to: 0.2
 🔧 [WALL TRANSPARENCY] Updating wall material opacity to: 0.2
 ✅ [WALL TRANSPARENCY] Preserving AirEntry material - hasTexture: false opacity: 0.7
chunk-WERSD76P.js:18625 [Violation] 'click' handler took 205ms
 Double-click position search: {airEntryData: {…}, entryPosition: {…}, storedEntryIndex: 0}
 Double-click found entry using stored entryIndex: 0
 🔍 [CANVAS3D DOUBLECLICK] baseEntry from store: {type: 'vent', position: {…}, line: {…}, dimensions: {…}}
 🔍 [CANVAS3D DOUBLECLICK] baseEntry.dimensions: {width: 60, height: 40, distanceToFloor: 110, shape: 'rectangular', wallPosition: 0}
 🔍 [CANVAS3D DOUBLECLICK] baseEntry.dimensions.wallPosition: 0
 🔍 [CANVAS3D DOUBLECLICK] updatedData from ref: undefined
 🔍 [CANVAS3D DOUBLECLICK] mergedEntry: {type: 'vent', position: {…}, line: {…}, dimensions: {…}}
 🔍 [CANVAS3D DOUBLECLICK] mergedEntry.dimensions.wallPosition: 0
 🔍 [CANVAS3D DOUBLECLICK] Dialog opening with index: 0
 🎯 [SAVE BUTTON CLICKED] AirEntryDialog handleSubmit triggered
 🎯 [SAVE BUTTON CLICKED] Event type: submit
 🎯 [SAVE BUTTON CLICKED] Props type: vent
 🎯 [SAVE BUTTON CLICKED] Current values: {width: 60, height: 40, distanceToFloor: 110, shape: 'rectangular', wallPosition: undefined, …}
 🎯 [SAVE BUTTON CLICKED] wallPosition from values: undefined
 🎯 [SAVE BUTTON CLICKED] wallPosition from state: 0
 🎯 [PROPS.ONCONFIRM] About to call props.onConfirm with canvasData
 🎯 [PROPS.ONCONFIRM] canvasData being sent: {width: 60, height: 40, distanceToFloor: 110, shape: 'rectangular', wallPosition: 0, …}
 🎯 [PROPS.ONCONFIRM] canvasData.wallPosition: 0
 🎯 [PROPS.ONCONFIRM] canvasData.position: {x: 684.52, y: 42.01}
 🎯 [PROPS.ONCONFIRM] This should trigger handleAirEntryEdit in Canvas2D
 [CANVAS3D ONCONFIRM] Received data from dialog: {width: 60, height: 40, distanceToFloor: 110, shape: 'rectangular', wallPosition: 0, …}
 [CANVAS3D ONCONFIRM] wallPosition in received data: 0
 🔍 [SAVE CHANGES DEBUG] About to call handleAirEntryEdit
 🔍 [CANVAS3D handleAirEntryEdit] Called with index: 0
 🔍 [CANVAS3D handleAirEntryEdit] Received data: {width: 60, height: 40, distanceToFloor: 110, shape: 'rectangular', wallPosition: 0, …}
 🔍 [CANVAS3D handleAirEntryEdit] data.wallPosition: 0
 🚀 Canvas3D: Llamando onUpdateAirEntry - piso: ground, índice: 0
 🚀 Canvas3D: Datos del AirEntry actualizado: {type: 'vent', position: {…}, line: {…}, dimensions: {…}, properties: {…}}
 🎯 WIZARD: handleUpdateAirEntryFrom3D llamado - piso: ground, índice: 0
 🎯 WIZARD: Datos recibidos del AirEntry: {type: 'vent', position: {…}, line: {…}, dimensions: {…}, properties: {…}}
 📝 WIZARD: Entry clonado con wallPosition preservado: {type: 'vent', position: {…}, line: {…}, dimensions: {…}, properties: {…}}
 ✅ WIZARD: Actualizando piso actual - procediendo con la actualización del store
 📋 WIZARD: setAirEntries ejecutado con nuevo array
 📋 WIZARD: useRoomStore.setFloors ejecutado
 🚨 WIZARD: CRÍTICO - No se está llamando updateAirEntry del store para la sincronización
 🚨 WIZARD: Esto explica por qué no se notifica a otros componentes
 🔧 WIZARD: Llamando updateAirEntry para disparar sincronización
 🔄 STORE: updateAirEntry llamado - piso: ground, índice: 0
 🔄 STORE: Nueva posición del AirEntry: (684.52, 42.01)
 ✅ STORE: AirEntry actualizado en el store, notificando a 1 listeners
 📢 STORE: Notificando listener 1/1
 📥 Canvas3D: Recibida notificación de cambio AirEntry - piso: ground, índice: 0
 📥 Canvas3D: Tipo: vent, posición: (684.52, 42.01)
 ✅ Canvas3D: Aplicando cambio - buscando objetos en escena 3D
 🎯 Canvas3D: Encontrado objeto vent para actualizar - índice: 0
 🎯 Canvas3D: Objeto actualizado - nueva posición 3D: (355.65, 322.4875, 110)
 📊 Canvas3D: Objetos encontrados: 1, actualizados: 1
 🔄 Canvas3D: Forzando re-render de la escena
 📥 Canvas3D: Recibida notificación de cambio AirEntry - piso: ground, índice: 0
 📥 Canvas3D: Tipo: vent, posición: (684.52, 42.01)
 ✅ Canvas3D: Aplicando cambio - buscando objetos en escena 3D
 🎯 Canvas3D: Encontrado objeto vent para actualizar - índice: 0
 🎯 Canvas3D: Objeto actualizado - nueva posición 3D: (355.65, 322.4875, 110)
 📊 Canvas3D: Objetos encontrados: 1, actualizados: 1
 🔄 Canvas3D: Forzando re-render de la escena
 ✅ WIZARD: updateAirEntry completado - debería notificar a Canvas2D, Canvas3D y RSP
 ✅ Canvas3D: onUpdateAirEntry completado - debería haber actualizado el store
 📋 Canvas3D: Verificando si esto dispara notificaciones a otros componentes...
 🔍 [BEFORE CLOSE] Mesh 0 material: {hasMap: false, opacity: 0.7, type: 'vent'}
 🔬 [DEPENDENCY TRACKING] BEFORE setEditingAirEntry(null):
 🔬 [DEPENDENCY TRACKING] floors keys: ['ground']
 🔬 [DEPENDENCY TRACKING] currentFloor: ground
 🔬 [DEPENDENCY TRACKING] ceilingHeight: 220
 🔬 [DEPENDENCY TRACKING] floorDeckThickness: 35
 🔬 [DEPENDENCY TRACKING] floors[currentFloor] airEntries length: 1
 🔬 [DEPENDENCY TRACKING] selectedAirEntry state: NULL
 🔬 [DEPENDENCY TRACKING] AFTER setEditingAirEntry(null):
 🔬 [DEPENDENCY TRACKING] floors keys: ['ground']
 🔬 [DEPENDENCY TRACKING] currentFloor: ground
 🔬 [DEPENDENCY TRACKING] ceilingHeight: 220
 🔬 [DEPENDENCY TRACKING] floorDeckThickness: 35
 🔬 [DEPENDENCY TRACKING] floors[currentFloor] airEntries length: 1
 🔬 [DEPENDENCY TRACKING] selectedAirEntry state: NULL
 ✅ [SAVE CHANGES] Data commit complete - monitoring for texture loss
 ✅ [SAVE CHANGES] Dialog closed - checking for side effects
 🔍 [SAVE CHANGES DEBUG] handleAirEntryEdit completed - checking for side effects
 🎯 [PROPS.ONCONFIRM] props.onConfirm completed
 🎯 [PROPS.ONCONFIRM] Now calling onClose() to close dialog
 🔍 [AFTER CLOSE] Checking textures immediately after dialog close
 🔍 [AFTER CLOSE] Mesh 0 material: {hasMap: false, opacity: 0.7, type: 'vent'}
 🔍 [SAVE CHANGES DEBUG] 100ms after Save Changes - checking scene state
 🔍 [SAVE CHANGES DEBUG] AirEntry meshes found: 1
 🔍 [SAVE CHANGES DEBUG] Mesh 0 material: {hasMap: false, opacity: 0.7, type: 'vent'}
 🔗 Canvas3D: Desregistrando suscripción para piso 'ground'
 🔗 STORE: Suscripción eliminada. Total listeners: 0
 🔗 Canvas3D: Registrando suscripción para sincronización de AirEntry en piso 'ground'
 🔗 STORE: Nueva suscripción añadida. Total listeners: 1
 🚨 [SCENE REBUILD TRIGGER] useEffect triggered - dependencies changed
 🚨 [SCENE REBUILD TRIGGER] floors reference: {ground: {…}}
 🚨 [SCENE REBUILD TRIGGER] floors identity hash: {"ground":{"lines":[{"id":"1751137688710_hex1ykx9c...
 🚨 [SCENE REBUILD TRIGGER] currentFloor: ground
 🚨 [SCENE REBUILD TRIGGER] ceilingHeight: 220
 🚨 [SCENE REBUILD TRIGGER] floorDeckThickness: 35
 🔧 [SCENE REBUILD] Creating new material for vent at index 0
 🔧 [WALL TRANSPARENCY] Updating wall transparency, preserving AirEntry textures
 🔧 [WALL TRANSPARENCY] Updating wall material opacity to: 0.2
 🔧 [WALL TRANSPARENCY] Updating wall material opacity to: 0.2
 🔧 [WALL TRANSPARENCY] Updating wall material opacity to: 0.2
 🔧 [WALL TRANSPARENCY] Updating wall material opacity to: 0.2
 🔧 [WALL TRANSPARENCY] Updating wall material opacity to: 0.2
 ✅ [WALL TRANSPARENCY] Preserving AirEntry material - hasTexture: false opacity: 0.7
 ✅ [TRANSPARENCY UPDATE] Preserving existing material properties, only updating opacity
 ✅ [TRANSPARENCY UPDATE] Material has texture: true
 🔗 RSP: Registrando suscripción para sincronización de AirEntry
 🔗 STORE: Nueva suscripción añadida. Total listeners: 2
chunk-WERSD76P.js:18625 [Violation] 'click' handler took 251ms
wizard-design:1 [.WebGL-0x2c640f3da300] GL_INVALID_OPERATION: Texture is immutable.
wizard-design:1 [.WebGL-0x2c640f3da300] GL_INVALID_OPERATION: Texture is immutable.
wizard-design:1 [.WebGL-0x2c640f3da300] GL_INVALID_OPERATION: Texture is immutable.
wizard-design:1 [.WebGL-0x2c640f3da300] GL_INVALID_OPERATION: Texture is immutable.
 🔗 RSP: Desregistrando suscripción para sincronización de AirEntry
 🔗 STORE: Suscripción eliminada. Total listeners: 1
 🔗 Canvas3D: Desregistrando suscripción para piso 'ground'
 🔗 STORE: Suscripción eliminada. Total listeners: 0
 🔗 Canvas3D: Registrando suscripción para sincronización de AirEntry en piso 'ground'
 🔗 STORE: Nueva suscripción añadida. Total listeners: 1
 🚨 [SCENE REBUILD TRIGGER] useEffect triggered - dependencies changed
 🚨 [SCENE REBUILD TRIGGER] floors reference: {ground: {…}}
 🚨 [SCENE REBUILD TRIGGER] floors identity hash: {"ground":{"lines":[{"id":"1751137688710_hex1ykx9c...
 🚨 [SCENE REBUILD TRIGGER] currentFloor: ground
 🚨 [SCENE REBUILD TRIGGER] ceilingHeight: 220
 🚨 [SCENE REBUILD TRIGGER] floorDeckThickness: 35
 🔧 [SCENE REBUILD] Creating new material for vent at index 0
 🔧 [WALL TRANSPARENCY] Updating wall transparency, preserving AirEntry textures
 🔧 [WALL TRANSPARENCY] Updating wall material opacity to: 0.2
 🔧 [WALL TRANSPARENCY] Updating wall material opacity to: 0.2
 🔧 [WALL TRANSPARENCY] Updating wall material opacity to: 0.2
 🔧 [WALL TRANSPARENCY] Updating wall material opacity to: 0.2
 🔧 [WALL TRANSPARENCY] Updating wall material opacity to: 0.2
 ✅ [WALL TRANSPARENCY] Preserving AirEntry material - hasTexture: false opacity: 0.7
chunk-WERSD76P.js:18625 [Violation] 'click' handler took 356ms
wizard-design:1 [.WebGL-0x2c640f3e5400] GL_INVALID_OPERATION: Texture is immutable.
wizard-design:1 [.WebGL-0x2c640f3e5400] GL_INVALID_OPERATION: Texture is immutable.
wizard-design:1 [.WebGL-0x2c640f3e5400] GL_INVALID_OPERATION: Texture is immutable.
wizard-design:1 [.WebGL-0x2c640f3e5400] GL_INVALID_OPERATION: Texture is immutable.
wizard-design:1 [.WebGL-0x2c640f3e5400] GL_INVALID_OPERATION: Texture is immutable.
wizard-design:1 [.WebGL-0x2c640f3e5400] GL_INVALID_OPERATION: Texture is immutable.
wizard-design:1 [.WebGL-0x2c640f3e5400] GL_INVALID_OPERATION: Texture is immutable.
 Double-click position search: {airEntryData: {…}, entryPosition: {…}, storedEntryIndex: 0}
 Double-click found entry using stored entryIndex: 0
 🔍 [CANVAS3D DOUBLECLICK] baseEntry from store: {type: 'vent', position: {…}, line: {…}, dimensions: {…}}
 🔍 [CANVAS3D DOUBLECLICK] baseEntry.dimensions: {width: 60, height: 40, distanceToFloor: 110, shape: 'rectangular', wallPosition: 0}
 🔍 [CANVAS3D DOUBLECLICK] baseEntry.dimensions.wallPosition: 0
 🔍 [CANVAS3D DOUBLECLICK] updatedData from ref: undefined
 🔍 [CANVAS3D DOUBLECLICK] mergedEntry: {type: 'vent', position: {…}, line: {…}, dimensions: {…}}
 🔍 [CANVAS3D DOUBLECLICK] mergedEntry.dimensions.wallPosition: 0
 🔍 [CANVAS3D DOUBLECLICK] Dialog opening with index: 0
 🏠 [AIRENTRY DIRECT] Updating position directly for vent - similar to furniture
 ✅ [AIRENTRY DIRECT] Position updated directly - Material: MeshPhongMaterial, HasTexture: false
 🔍 [HYPOTHESIS TEST] About to call onUpdateAirEntry - this may trigger floors modification
 🔍 [HYPOTHESIS TEST] Current floors object reference: object
 🎯 WIZARD: handleUpdateAirEntryFrom3D llamado - piso: ground, índice: 0
 🎯 WIZARD: Datos recibidos del AirEntry: {type: 'vent', position: {…}, line: {…}, dimensions: {…}}
 📝 WIZARD: Entry clonado con wallPosition preservado: {type: 'vent', position: {…}, line: {…}, dimensions: {…}}
 ✅ WIZARD: Actualizando piso actual - procediendo con la actualización del store
 📋 WIZARD: setAirEntries ejecutado con nuevo array
 📋 WIZARD: useRoomStore.setFloors ejecutado
 🚨 WIZARD: CRÍTICO - No se está llamando updateAirEntry del store para la sincronización
 🚨 WIZARD: Esto explica por qué no se notifica a otros componentes
 🔧 WIZARD: Llamando updateAirEntry para disparar sincronización
 🔄 STORE: updateAirEntry llamado - piso: ground, índice: 0
 🔄 STORE: Nueva posición del AirEntry: (679.065273113736, 45.93250906203916)
 ✅ STORE: AirEntry actualizado en el store, notificando a 1 listeners
 📢 STORE: Notificando listener 1/1
 📥 Canvas3D: Recibida notificación de cambio AirEntry - piso: ground, índice: 0
 📥 Canvas3D: Tipo: vent, posición: (679.065273113736, 45.93250906203916)
 ✅ Canvas3D: Aplicando cambio - buscando objetos en escena 3D
 🎯 Canvas3D: Encontrado objeto vent para actualizar - índice: 0
 🎯 Canvas3D: Objeto actualizado - nueva posición 3D: (348.83159139217, 317.58436367245105, 110)
 📊 Canvas3D: Objetos encontrados: 1, actualizados: 1
 🔄 Canvas3D: Forzando re-render de la escena
 📥 Canvas3D: Recibida notificación de cambio AirEntry - piso: ground, índice: 0
 📥 Canvas3D: Tipo: vent, posición: (679.065273113736, 45.93250906203916)
 ✅ Canvas3D: Aplicando cambio - buscando objetos en escena 3D
 🎯 Canvas3D: Encontrado objeto vent para actualizar - índice: 0
 🎯 Canvas3D: Objeto actualizado - nueva posición 3D: (348.83159139217, 317.58436367245105, 110)
 📊 Canvas3D: Objetos encontrados: 1, actualizados: 1
 🔄 Canvas3D: Forzando re-render de la escena
 ✅ WIZARD: updateAirEntry completado - debería notificar a Canvas2D, Canvas3D y RSP
 🔍 [HYPOTHESIS TEST] onUpdateAirEntry completed - floors may have been modified
 ✅ [OPTIMIZATION] Position update complete - textures preserved automatically
chunk-WERSD76P.js:18625 [Violation] 'setTimeout' handler took 52ms
 🏠 [AIRENTRY DIRECT] Updating position directly for vent - similar to furniture
 ✅ [AIRENTRY DIRECT] Position updated directly - Material: MeshPhongMaterial, HasTexture: false
 🏠 [AIRENTRY DIRECT] Updating position directly for vent - similar to furniture
 ✅ [AIRENTRY DIRECT] Position updated directly - Material: MeshPhongMaterial, HasTexture: false
 🔍 [HYPOTHESIS TEST] About to call onUpdateAirEntry - this may trigger floors modification
 🔍 [HYPOTHESIS TEST] Current floors object reference: object
 🎯 WIZARD: handleUpdateAirEntryFrom3D llamado - piso: ground, índice: 0
 🎯 WIZARD: Datos recibidos del AirEntry: {type: 'vent', position: {…}, line: {…}, dimensions: {…}}
 📝 WIZARD: Entry clonado con wallPosition preservado: {type: 'vent', position: {…}, line: {…}, dimensions: {…}}
 ✅ WIZARD: Actualizando piso actual - procediendo con la actualización del store
 📋 WIZARD: setAirEntries ejecutado con nuevo array
 📋 WIZARD: useRoomStore.setFloors ejecutado
 🚨 WIZARD: CRÍTICO - No se está llamando updateAirEntry del store para la sincronización
 🚨 WIZARD: Esto explica por qué no se notifica a otros componentes
 🔧 WIZARD: Llamando updateAirEntry para disparar sincronización
 🔄 STORE: updateAirEntry llamado - piso: ground, índice: 0
 🔄 STORE: Nueva posición del AirEntry: (139.4844151900653, 433.98723565098044)
 ✅ STORE: AirEntry actualizado en el store, notificando a 1 listeners
 📢 STORE: Notificando listener 1/1
 📥 Canvas3D: Recibida notificación de cambio AirEntry - piso: ground, índice: 0
 📥 Canvas3D: Tipo: vent, posición: (139.4844151900653, 433.98723565098044)
 ✅ Canvas3D: Aplicando cambio - buscando objetos en escena 3D
 🎯 Canvas3D: Encontrado objeto vent para actualizar - índice: 0
 🎯 Canvas3D: Objeto actualizado - nueva posición 3D: (-325.6444810124184, -167.48404456372555, 110)
 📊 Canvas3D: Objetos encontrados: 1, actualizados: 1
 🔄 Canvas3D: Forzando re-render de la escena
 📥 Canvas3D: Recibida notificación de cambio AirEntry - piso: ground, índice: 0
 📥 Canvas3D: Tipo: vent, posición: (139.4844151900653, 433.98723565098044)
 ✅ Canvas3D: Aplicando cambio - buscando objetos en escena 3D
 🎯 Canvas3D: Encontrado objeto vent para actualizar - índice: 0
 🎯 Canvas3D: Objeto actualizado - nueva posición 3D: (-325.6444810124184, -167.48404456372555, 110)
 📊 Canvas3D: Objetos encontrados: 1, actualizados: 1
 🔄 Canvas3D: Forzando re-render de la escena
 ✅ WIZARD: updateAirEntry completado - debería notificar a Canvas2D, Canvas3D y RSP
 🔍 [HYPOTHESIS TEST] onUpdateAirEntry completed - floors may have been modified
 ✅ [OPTIMIZATION] Position update complete - textures preserved automatically
 🎯 [SAVE BUTTON CLICKED] AirEntryDialog handleSubmit triggered
 🎯 [SAVE BUTTON CLICKED] Event type: submit
 🎯 [SAVE BUTTON CLICKED] Props type: vent
 🎯 [SAVE BUTTON CLICKED] Current values: {width: 60, height: 40, distanceToFloor: 110, shape: 'rectangular', wallPosition: 100, …}
 🎯 [SAVE BUTTON CLICKED] wallPosition from values: 100
 🎯 [SAVE BUTTON CLICKED] wallPosition from state: 100
 🎯 [PROPS.ONCONFIRM] About to call props.onConfirm with canvasData
 🎯 [PROPS.ONCONFIRM] canvasData being sent: {width: 60, height: 40, distanceToFloor: 110, shape: 'rectangular', wallPosition: 100, …}
 🎯 [PROPS.ONCONFIRM] canvasData.wallPosition: 100
 🎯 [PROPS.ONCONFIRM] canvasData.position: {x: 139.4844151900653, y: 433.98723565098044}
 🎯 [PROPS.ONCONFIRM] This should trigger handleAirEntryEdit in Canvas2D
 [CANVAS3D ONCONFIRM] Received data from dialog: {width: 60, height: 40, distanceToFloor: 110, shape: 'rectangular', wallPosition: 100, …}
 [CANVAS3D ONCONFIRM] wallPosition in received data: 100
 🔍 [SAVE CHANGES DEBUG] About to call handleAirEntryEdit
 🔍 [CANVAS3D handleAirEntryEdit] Called with index: 0
 🔍 [CANVAS3D handleAirEntryEdit] Received data: {width: 60, height: 40, distanceToFloor: 110, shape: 'rectangular', wallPosition: 100, …}
 🔍 [CANVAS3D handleAirEntryEdit] data.wallPosition: 100
 🚀 Canvas3D: Llamando onUpdateAirEntry - piso: ground, índice: 0
 🚀 Canvas3D: Datos del AirEntry actualizado: {type: 'vent', position: {…}, line: {…}, dimensions: {…}, properties: {…}}
 🎯 WIZARD: handleUpdateAirEntryFrom3D llamado - piso: ground, índice: 0
 🎯 WIZARD: Datos recibidos del AirEntry: {type: 'vent', position: {…}, line: {…}, dimensions: {…}, properties: {…}}
 📝 WIZARD: Entry clonado con wallPosition preservado: {type: 'vent', position: {…}, line: {…}, dimensions: {…}, properties: {…}}
 ✅ WIZARD: Actualizando piso actual - procediendo con la actualización del store
 📋 WIZARD: setAirEntries ejecutado con nuevo array
 📋 WIZARD: useRoomStore.setFloors ejecutado
 🚨 WIZARD: CRÍTICO - No se está llamando updateAirEntry del store para la sincronización
 🚨 WIZARD: Esto explica por qué no se notifica a otros componentes
 🔧 WIZARD: Llamando updateAirEntry para disparar sincronización
 🔄 STORE: updateAirEntry llamado - piso: ground, índice: 0
 🔄 STORE: Nueva posición del AirEntry: (139.4844151900653, 433.98723565098044)
 ✅ STORE: AirEntry actualizado en el store, notificando a 1 listeners
 📢 STORE: Notificando listener 1/1
 📥 Canvas3D: Recibida notificación de cambio AirEntry - piso: ground, índice: 0
 📥 Canvas3D: Tipo: vent, posición: (139.4844151900653, 433.98723565098044)
 ✅ Canvas3D: Aplicando cambio - buscando objetos en escena 3D
 🎯 Canvas3D: Encontrado objeto vent para actualizar - índice: 0
 🎯 Canvas3D: Objeto actualizado - nueva posición 3D: (-325.6444810124184, -167.48404456372555, 110)
 📊 Canvas3D: Objetos encontrados: 1, actualizados: 1
 🔄 Canvas3D: Forzando re-render de la escena
 📥 Canvas3D: Recibida notificación de cambio AirEntry - piso: ground, índice: 0
 📥 Canvas3D: Tipo: vent, posición: (139.4844151900653, 433.98723565098044)
 ✅ Canvas3D: Aplicando cambio - buscando objetos en escena 3D
 🎯 Canvas3D: Encontrado objeto vent para actualizar - índice: 0
 🎯 Canvas3D: Objeto actualizado - nueva posición 3D: (-325.6444810124184, -167.48404456372555, 110)
 📊 Canvas3D: Objetos encontrados: 1, actualizados: 1
 🔄 Canvas3D: Forzando re-render de la escena
 ✅ WIZARD: updateAirEntry completado - debería notificar a Canvas2D, Canvas3D y RSP
 ✅ Canvas3D: onUpdateAirEntry completado - debería haber actualizado el store
 📋 Canvas3D: Verificando si esto dispara notificaciones a otros componentes...
 🔍 [BEFORE CLOSE] Mesh 0 material: {hasMap: false, opacity: 0.7, type: 'vent'}
 🔬 [DEPENDENCY TRACKING] BEFORE setEditingAirEntry(null):
 🔬 [DEPENDENCY TRACKING] floors keys: ['ground']
 🔬 [DEPENDENCY TRACKING] currentFloor: ground
 🔬 [DEPENDENCY TRACKING] ceilingHeight: 220
 🔬 [DEPENDENCY TRACKING] floorDeckThickness: 35
 🔬 [DEPENDENCY TRACKING] floors[currentFloor] airEntries length: 1
 🔬 [DEPENDENCY TRACKING] selectedAirEntry state: NULL
 🔬 [DEPENDENCY TRACKING] AFTER setEditingAirEntry(null):
 🔬 [DEPENDENCY TRACKING] floors keys: ['ground']
 🔬 [DEPENDENCY TRACKING] currentFloor: ground
 🔬 [DEPENDENCY TRACKING] ceilingHeight: 220
 🔬 [DEPENDENCY TRACKING] floorDeckThickness: 35
 🔬 [DEPENDENCY TRACKING] floors[currentFloor] airEntries length: 1
 🔬 [DEPENDENCY TRACKING] selectedAirEntry state: NULL
 ✅ [SAVE CHANGES] Data commit complete - monitoring for texture loss
 ✅ [SAVE CHANGES] Dialog closed - checking for side effects
 🔍 [SAVE CHANGES DEBUG] handleAirEntryEdit completed - checking for side effects
 🎯 [PROPS.ONCONFIRM] props.onConfirm completed
 🎯 [PROPS.ONCONFIRM] Now calling onClose() to close dialog
 🔍 [AFTER CLOSE] Checking textures immediately after dialog close
 🔍 [AFTER CLOSE] Mesh 0 material: {hasMap: false, opacity: 0.7, type: 'vent'}
 🔍 [SAVE CHANGES DEBUG] 100ms after Save Changes - checking scene state
 🔍 [SAVE CHANGES DEBUG] AirEntry meshes found: 1
 🔍 [SAVE CHANGES DEBUG] Mesh 0 material: {hasMap: false, opacity: 0.7, type: 'vent'}
 📊 Analytics Event: {category: 'ui_interaction', action: 'change_tab', label: 'view_2d_editor', value: undefined, status: 'sent'}
 📊 WIZARD: Pasando airEntries a Canvas2D
 📊 WIZARD: rawFloors[ground] existe: true
 📊 WIZARD: rawFloors[ground]?.airEntries length: 1
 📊 WIZARD: fallback airEntries length: 1
 📊 WIZARD: Usando rawAirEntries: SÍ (rawFloors)
 📊 WIZARD: Primer airEntry enviado a Canvas2D - posición: (139.4844151900653, 433.98723565098044)
 🔗 Canvas3D: Desregistrando suscripción para piso 'ground'
 🔗 STORE: Suscripción eliminada. Total listeners: 0
 🔗 Canvas2D: Registrando suscripción para piso 'ground'
 🔗 Canvas2D: subscribeToAirEntryChanges función disponible: true
 🔗 STORE: Nueva suscripción añadida. Total listeners: 1
 🔗 Canvas2D: Suscripción creada exitosamente: true
 📊 WIZARD: Pasando airEntries a Canvas2D
 📊 WIZARD: rawFloors[ground] existe: true
 📊 WIZARD: rawFloors[ground]?.airEntries length: 1
 📊 WIZARD: fallback airEntries length: 1
 📊 WIZARD: Usando rawAirEntries: SÍ (rawFloors)
 📊 WIZARD: Primer airEntry enviado a Canvas2D - posición: (139.4844151900653, 433.98723565098044)
wizard-design:1 [.WebGL-0x2c64126f8e00] GL_INVALID_OPERATION: Texture is immutable.
wizard-design:1 [.WebGL-0x2c64126f8e00] GL_INVALID_OPERATION: Texture is immutable.
wizard-design:1 [.WebGL-0x2c64126f8e00] GL_INVALID_OPERATION: Texture is immutable.
wizard-design:1 [.WebGL-0x2c64126f8e00] GL_INVALID_OPERATION: Texture is immutable.
 📊 Analytics Event: {category: 'ui_interaction', action: 'change_tab', label: 'view_3d_preview', value: undefined, status: 'sent'}
 🔗 Canvas2D: Desregistrando suscripción para piso 'ground'
 🔗 STORE: Suscripción eliminada. Total listeners: 0
 🔗 Canvas3D: Registrando suscripción para sincronización de AirEntry en piso 'ground'
 🔗 STORE: Nueva suscripción añadida. Total listeners: 1
 🚨 [SCENE REBUILD TRIGGER] useEffect triggered - dependencies changed
 🚨 [SCENE REBUILD TRIGGER] floors reference: {ground: {…}}
 🚨 [SCENE REBUILD TRIGGER] floors identity hash: {"ground":{"lines":[{"id":"1751137688710_hex1ykx9c...
 🚨 [SCENE REBUILD TRIGGER] currentFloor: ground
 🚨 [SCENE REBUILD TRIGGER] ceilingHeight: 220
 🚨 [SCENE REBUILD TRIGGER] floorDeckThickness: 35
 🔧 [SCENE REBUILD] Creating new material for vent at index 0
 🔧 [WALL TRANSPARENCY] Updating wall transparency, preserving AirEntry textures
 🔧 [WALL TRANSPARENCY] Updating wall material opacity to: 0.2
 🔧 [WALL TRANSPARENCY] Updating wall material opacity to: 0.2
 🔧 [WALL TRANSPARENCY] Updating wall material opacity to: 0.2
 🔧 [WALL TRANSPARENCY] Updating wall material opacity to: 0.2
 🔧 [WALL TRANSPARENCY] Updating wall material opacity to: 0.2
 ✅ [WALL TRANSPARENCY] Preserving AirEntry material - hasTexture: false opacity: 0.7
chunk-WERSD76P.js:18625 [Violation] 'click' handler took 264ms
 📊 Analytics Event: {category: 'ui_interaction', action: 'change_tab', label: 'view_2d_editor', value: undefined, status: 'sent'}
 📊 WIZARD: Pasando airEntries a Canvas2D
 📊 WIZARD: rawFloors[ground] existe: true
 📊 WIZARD: rawFloors[ground]?.airEntries length: 1
 📊 WIZARD: fallback airEntries length: 1
 📊 WIZARD: Usando rawAirEntries: SÍ (rawFloors)
 📊 WIZARD: Primer airEntry enviado a Canvas2D - posición: (139.4844151900653, 433.98723565098044)
 🔗 Canvas3D: Desregistrando suscripción para piso 'ground'
 🔗 STORE: Suscripción eliminada. Total listeners: 0
 🔗 Canvas2D: Registrando suscripción para piso 'ground'
 🔗 Canvas2D: subscribeToAirEntryChanges función disponible: true
 🔗 STORE: Nueva suscripción añadida. Total listeners: 1
 🔗 Canvas2D: Suscripción creada exitosamente: true
 📊 WIZARD: Pasando airEntries a Canvas2D
 📊 WIZARD: rawFloors[ground] existe: true
 📊 WIZARD: rawFloors[ground]?.airEntries length: 1
 📊 WIZARD: fallback airEntries length: 1
 📊 WIZARD: Usando rawAirEntries: SÍ (rawFloors)
 📊 WIZARD: Primer airEntry enviado a Canvas2D - posición: (139.4844151900653, 433.98723565098044)
wizard-design:1 [.WebGL-0x2c640f3e5b00] GL_INVALID_OPERATION: Texture is immutable.
wizard-design:1 [.WebGL-0x2c640f3e5b00] GL_INVALID_OPERATION: Texture is immutable.
wizard-design:1 [.WebGL-0x2c640f3e5b00] GL_INVALID_OPERATION: Texture is immutable.
wizard-design:1 [.WebGL-0x2c640f3e5b00] GL_INVALID_OPERATION: Texture is immutable.
 📊 Analytics Event: {category: 'ui_interaction', action: 'change_tab', label: 'view_3d_preview', value: undefined, status: 'sent'}
 🔗 Canvas2D: Desregistrando suscripción para piso 'ground'
 🔗 STORE: Suscripción eliminada. Total listeners: 0
 🔗 Canvas3D: Registrando suscripción para sincronización de AirEntry en piso 'ground'
 🔗 STORE: Nueva suscripción añadida. Total listeners: 1
 🚨 [SCENE REBUILD TRIGGER] useEffect triggered - dependencies changed
 🚨 [SCENE REBUILD TRIGGER] floors reference: {ground: {…}}
 🚨 [SCENE REBUILD TRIGGER] floors identity hash: {"ground":{"lines":[{"id":"1751137688710_hex1ykx9c...
 🚨 [SCENE REBUILD TRIGGER] currentFloor: ground
 🚨 [SCENE REBUILD TRIGGER] ceilingHeight: 220
 🚨 [SCENE REBUILD TRIGGER] floorDeckThickness: 35
 🔧 [SCENE REBUILD] Creating new material for vent at index 0
 🔧 [WALL TRANSPARENCY] Updating wall transparency, preserving AirEntry textures
 🔧 [WALL TRANSPARENCY] Updating wall material opacity to: 0.2
 🔧 [WALL TRANSPARENCY] Updating wall material opacity to: 0.2
 🔧 [WALL TRANSPARENCY] Updating wall material opacity to: 0.2
 🔧 [WALL TRANSPARENCY] Updating wall material opacity to: 0.2
 🔧 [WALL TRANSPARENCY] Updating wall material opacity to: 0.2
 ✅ [WALL TRANSPARENCY] Preserving AirEntry material - hasTexture: false opacity: 0.7
chunk-WERSD76P.js:18625 [Violation] 'click' handler took 248ms
Canvas3D.tsx:1841 [Violation] 'requestAnimationFrame' handler took 50ms
